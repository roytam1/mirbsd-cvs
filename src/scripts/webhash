#!/bin/mksh
# $MirOS: src/scripts/webhash,v 1.1 2018/06/26 21:39:19 tg Exp $

die() {
	print -ru2 -- "E: $0: $*"
	exit 1
}

[[ $1 = /* && -d $1/. ]] || die "\$1 ($1) not a directory"
cd "$1" || die "could not cd to: $1"

num=${2:-1}
[[ $num = [1-9]*([0-9]) ]] || die "\$2 ($num) not numeric"
spc=
while (( num-- )); do
	spc+=' '
done

ls
read fn?'File? '
[[ -s $fn ]] || die "file '$fn' does not exist or is empty"

(
	cksum -a sha256 -a rmd160 -a tiger -- "$fn"
	cksum -- "$PWD/$fn"
	md5 -- "$fn"
) | sed "s!^.*\$!$spc<li>&</li>!"
