#!/usr/bin/env mksh
# $MirOS: src/sys/arch/sparc/stand/bootxx/mkbxinst.sh,v 1.17 2009/02/02 23:59:50 tg Exp $
# $miros: src/sys/arch/sparc/stand/bootxx/mkbxinst.sh,v 1.17 2009/02/02 23:59:50 tg Exp $
#-
# Copyright (c) 2007, 2008, 2009
#	Thorsten Glaser <tg@mirbsd.org>
#
# Provided that these terms and disclaimer and all copyright notices
# are retained or reproduced in an accompanying document, permission
# is granted to deal in this work without restriction, including un‐
# limited rights to use, publicly perform, distribute, sell, modify,
# merge, give away, or sublicence.
#
# This work is provided “AS IS” and WITHOUT WARRANTY of any kind, to
# the utmost extent permitted by applicable law, neither express nor
# implied; without malicious intent or gross negligence. In no event
# may a licensor, author or contributor be held liable for indirect,
# direct, other damage, loss, or other issues arising in any way out
# of dealing in the work, even if advised of the possibility of such
# damage or existence of a defect, except proven that it results out
# of said person’s immediate fault when using the work as intended.
#-
# Self-installing 32-bit sun4m/sun4c boot blocks for MirOS BSD/sparc
# Reads a list of extents (firstblock lastblock) from standard input
# and writes bootxx to standard output, which can subsequentially be
# stored past the SunOS disklabel directly on the disc.

set -A pbs_thecode 0x66 0x31 0xC0 0x66 0x50 0x66 0x9D 0x05 0xA0 0x07 0x8E 0xD0 0xBC 0xFC 0xFF 0xFB 0x50 0x68 0x24 0x00 0x8E 0xD8 0x8E 0xC0 0x31 0xFF 0xBE 0x00 0x02 0xB9 0x80 0x00 0xF3 0x66 0xA5 0xCB 0xB8 0x01 0x02 0xBB 0x00 0x02 0xB9 0x19 0x00 0xB6 0x00 0x60 0xCD 0x13 0x61 0x73 0x08 0x60 0x31 0xC0 0xCD 0x13 0x61 0xEB 0xF2 0xEA 0x00 0x7C 0x00 0x00
typeset -Uui8 pbs_thecode
typeset -i pbs_ofs_sector=43 pbs_curptr=66

function pbs_output {
	typeset ostr=
	typeset -i psz

	# fill the block table
	(( pbs_thecode[pbs_ofs_sector] = $1 + 1 ))
	while (( pbs_curptr < 126 )); do
		(( pbs_thecode[pbs_curptr++] = RANDOM & 0xFF ))
	done

	# create the Sun disklabel
	while (( pbs_curptr < 512 )); do
		pbs_thecode[pbs_curptr++]=0
	done

	# rpm
	pbs_thecode[420]=0x01
	pbs_thecode[421]=0x2C
	# pcyl
	(( pbs_thecode[422] = (g_code[0] >> 8) & 0xFF ))
	(( pbs_thecode[423] = g_code[0] & 0xFF ))
	# interleave
	pbs_thecode[431]=1
	# ncyl
	(( pbs_thecode[432] = (g_code[0] >> 8) & 0xFF ))
	(( pbs_thecode[433] = g_code[0] & 0xFF ))
	# ntrk
	(( pbs_thecode[436] = (g_code[1] >> 8) & 0xFF ))
	(( pbs_thecode[437] = g_code[1] & 0xFF ))
	# nsec
	(( pbs_thecode[438] = (g_code[2] >> 8) & 0xFF ))
	(( pbs_thecode[439] = g_code[2] & 0xFF ))
	# sectors per drive
	(( psz = g_code[0] * g_code[1] * g_code[2] ))
	# partitions
	print -u2 geometry is $psz sectors in ${g_code[0]} cylinders, \
	    ${g_code[1]} heads, ${g_code[2]} sectors per track
	(( pbs_thecode[448] = pbs_thecode[456] = pbs_thecode[464] = \
	    pbs_thecode[472] = (psz >> 24) & 0xFF ))
	(( pbs_thecode[449] = pbs_thecode[457] = pbs_thecode[465] = \
	    pbs_thecode[473] = (psz >> 16) & 0xFF ))
	(( pbs_thecode[450] = pbs_thecode[458] = pbs_thecode[466] = \
	    pbs_thecode[474] = (psz >> 8) & 0xFF ))
	(( pbs_thecode[451] = pbs_thecode[459] = pbs_thecode[467] = \
	    pbs_thecode[475] = psz & 0xFF ))
	# magic
	pbs_thecode[508]=0xDA
	pbs_thecode[509]=0xBE
	pbs_thecode[510]=0x55
	pbs_thecode[511]=0xAA

	# fill in the hashes
	pbs_curptr=0
	while (( pbs_curptr < 126 )); do
		(( pbs_thecode[126] ^= pbs_thecode[pbs_curptr++] ))
		(( pbs_thecode[127] ^= pbs_thecode[pbs_curptr++] ))
	done
	pbs_curptr=128
	while (( pbs_curptr < 512 )); do
		(( pbs_thecode[126] ^= pbs_thecode[pbs_curptr++] ))
		(( pbs_thecode[127] ^= pbs_thecode[pbs_curptr++] ))
	done

	# create the output string
	pbs_curptr=0
	while (( pbs_curptr < 512 )); do
		ostr=$ostr\\0${pbs_thecode[pbs_curptr++]#8#}
	done
	print -n "$ostr"
}

function out_int32 {
	typeset -Uui16 value=$1
	typeset -Uui8 ba bb bc bd

	(( ba = (value >> 24) & 0xFF ))
	(( bb = (value >> 16) & 0xFF ))
	(( bc = (value >> 8) & 0xFF ))
	(( bd = value & 0xFF ))
	print -n "\\0${ba#8#}\\0${bb#8#}\\0${bc#8#}\\0${bd#8#}"
}

typeset -i blktblsz=256
set -A blktblent
typeset -i blktblnum=0 firstblock lastblock i=0 sscale=0 chainsec=-1
set -A g_code 2048 1 640

while getopts ":0:g:N:S:" ch; do
	case $ch {
	(0)	if (( (chainsec = OPTARG) < 0 || OPTARG > 62 )); then
			print -u2 Error: invalid chain sector "'$OPTARG'"
			exit 1
		fi ;;
	(g)	if [[ $OPTARG != +([0-9]):+([0-9]):+([0-9]) ]]; then
			print -u2 Error: invalid geometry code "'$OPTARG'"
			exit 1
		fi
		saveIFS=$IFS
		IFS=:
		set -A g_code -- $OPTARG
		IFS=$saveIFS ;;
	(N)	;;
	(S)	if (( (sscale = OPTARG) < 0 || OPTARG > 24 )); then
			print -u2 Error: invalid sector scale "'$OPTARG'"
			exit 1
		fi ;;
	(*)	print -u2 'Syntax:
	bxinst [-0 secno [-g C:H:S]] [-S scale] <blocklist >loader
Default scale=0, geometry: 2048 cyls 1 head 640 secs, suggest secno=24'
		exit 1 ;;
	}
done
shift $((OPTIND - 1))

# output chain sector including Sun disklabel, if desired
(( chainsec >= 0 )) && pbs_output $chainsec

# zero-initialise the block array
while (( i < blktblsz )); do
	typeset -i blktblent[i++]=0
done

# read in the extents
while read firstblock lastblock junk; do
	while (( firstblock <= lastblock )); do
		(( blktblent[blktblnum++] = firstblock++ << sscale ))
	done
	if (( blktblnum > blktblsz )); then
		print -u2 Error: too many blocks, maximum $blktblsz
		exit 1
	fi
done

# verbose output
i=0
print -nu2 "using $blktblnum blocks of size $((512 << sscale)):"
while (( i < blktblnum )); do
	print -nu2 " ${blktblent[i++]}"
done
print -u2 .

# Part 1
print -n '\01\03\01\07\060\0200\0\07\0\0\0\0\0\0\01\0230\0\0\0\0\0\070\0\0\0\0\0\0\0\0\0\0\023\0\016\0\0222\022\0140\0\0235\0342\0177\0240\0100\0\0\0151\01\0\0\0\01\0\0\0\0127\0105\0126\0202\0\0\0220\0220\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0220\0220\01\0\0\0\0240\03\0377\0364\043\0\016\0\0242\024\0140\0\021\0\016\06\0220\022\042\0310\0244\042\0\021\0320\04\0\0\0240\04\040\04\0320\044\0100\0\0244\0244\0240\04\024\0277\0377\0374\0242\04\0140\04\03\0\016\0\0202\020\0141\0360\0201\0300\0100\0\01\0\0\0\021\0\016\06\0220\022\041\060\023\0\016\06\0222\022\0142\0310\0100\0\02\0302\0222\042\0100\010\0221\0110\0\0\0220\052\057\0\0201\0212\053\0\01\0\0\0\01\0\0\0\01\0\0\0\021\0\016\05\017\0\0\020\0200\0246\0\07\02\0200\0\07\01\0\0\0\023\0\016\06\0360\042\0142\0274\0210\020\040\01\0212\020\040\014\060\0200\0\03\0210\020\040\0\0212\020\040\015\0310\042\040\0130\021\0\016\05\0312\042\040\0144\0220\020\040\01\0213\052\0\05\021\0\016\05\0312\042\040\0134\0212\041\0140\01\021\0\016\05\0312\042\040\0140\0100\0\0\0131\0220\020\0\030\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0220\051\0\016\05\0100\0\02\0154\0320\05\040\0164\0242\0222\040\0\062\0200\0\05\047\0\016\05\021\0\016\04\020\0200\0\051\0220\022\042\0340\0244\020\040\0\0302\04\0340\0160\0200\0244\0200\01\026\0200\0\0106\01\0\0\0\011\0\016\05\0205\054\0240\02\0206\021\040\0170\0230\020\0\021\0232\07\0277\0364\0222\020\040\01\0324\0\0300\02\0200\0242\0240\0\022\0200\0\05\041\0\016\05\023\0\016\04\020\0200\0\027\0220\022\0142\0370\0336\06\040\04\0326\05\040\0164\0302\03\0340\04\0237\0300\0100\0\0320\06\040\010\0222\020\0\021\0200\0242\040\0\02\0200\0\05\0220\020\0\031\025\0\016\04\020\0200\0\013\0220\022\0243\020\0100\0\03\0317\0324\04\040\0164\0324\07\0277\0364\0326\04\040\0164\0200\0242\0200\013\02\0200\0\07\0200\0244\0240\0\031\0\016\04\0220\023\043\050\033\0\016\05\0100\0\02\0242\0222\023\0140\0150\022\0200\0\032\0310\07\0277\0364\021\077\0377\0300\0240\06\0177\0340\0310\06\0100\0\0200\0211\0\010\0222\020\0\031\02\0200\0\05\0220\020\0\020\07\0\0\077\0204\020\0343\0377\0210\011\0\02\0230\031\041\013\0226\031\041\010\0200\0240\0\014\0236\0140\077\0377\0200\0240\0\013\0202\0140\077\0377\0200\0223\0300\01\022\0200\0\04\0200\0241\041\07\022\0200\0\05\0310\07\0277\0364\0100\0\03\0254\0262\020\0\020\0310\07\0277\0364\0244\04\0240\01\0340\04\0340\0160\0200\0244\0200\020\06\0277\0377\0276\0262\06\0100\04\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0220\0100\0\0\0166\043\0\0\020\05\0\016\06\0202\020\040\04\0240\020\0242\0140\0222\020\040\0\0220\020\0\020\0224\07\0277\0364\0100\0\01\0335\0302\040\0242\0140\0200\0242\040\0\02\0200\0\06\023\0\016\05\021\0\016\04\0220\022\043\070\0100\0\02\0157\0222\022\0140\0150\0220\020\0\020\0177\0377\0377\0230\0222\020\0\021\0326\04\040\04\0324\02\0340\014\0237\0302\0200\0\0220\020\0\020\011\0\016\05\0306\01\040\0130\0200\0240\0340\0\02\0200\0\04\0220\020\0\021\031\0\016\06\0320\03\042\0274\0237\0304\0100\0\01\0\0\0\0100\0\01\031\01\0\0\0\01\0\0\0\0201\0303\0340\010\01\0\0\0\03\0\016\05\05\0\020\0177\0230\020\0243\0377\07\077\0374\0\05\0\015\0\033\0\01\0\0310\0\0140\0130\0200\0241\040\01\022\0200\0\06\01\0\0\0\0302\0210\0200\0140\0302\0250\0300\0140\020\0200\0\05\0204\0\0200\015\0302\0220\0200\0140\0302\0260\0300\0140\0204\0\0200\015\0200\0240\0200\014\04\0277\0377\0365\0206\0\0300\015\0201\0303\0340\010\01\0\0\0\0235\0343\0277\0230\0210\020\0\030\021\077\0363\0\061\077\0357\0\07\0\03\0177\0204\01\0\010\0202\020\0343\0377\0200\0240\0200\01\010\0200\0\05\0260\01\0\030\023\0\016\04\0100\0\02\067\0220\022\0143\0120\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0230\0210\020\0\030\021\0\04\0\061\0\021\0\07\0\03\0177\0204\01\0\010\0202\020\0343\0377\0200\0240\0200\01\010\0200\0\05\0260\01\0\030\023\0\016\04\0100\0\02\050\0220\022\0143\0140\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0230\0220\020\0\030\0260\020\040\0\0100\0\01\0273\0262\020\0\010\0200\0242\040\0\02\0200\0\04\01\0\0\0\0177\0377\0377\0332\0221\0350\0\010\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0230\0220\020\0\030\0177\0377\0377\0343\0222\020\0\031\0200\0242\040\0\02\0200\0\04\0260\020\0\010\0100\0\01\0327\0201\0350\0\0\01\0\0\0\0201\0307\0340\010\0201\0350\0\0\0201\0303\0340\010\0220\020\040\0\0201\0303\0340\010\0220\020\040\05\0235\0343\0277\0230\05\0\016\05\0302\0\0240\0130\0200\0240\0140\0\022\0200\0\046\063\0\016\06\07\077\0372\04\03\0\016\06\0202\020\0141\060\0304\0\0340\0234\0310\0\0340\050\0360\0\0340\0140\0372\0\0340\054\0370\0\0340\030\0366\0\0340\0134\0364\0\0340\034\0362\0\0340\024\0336\0\0340\0230\0332\0\0340\0314\0330\0\0340\014\0326\0\0340\0304\0304\040\0140\0160\05\0\016\06\0302\040\0242\0274\0310\040\0140\0110\011\0\016\06\0372\040\0140\0114\0370\040\0140\0124\0366\040\0140\0140\0364\040\0140\0130\0362\040\0140\0120\0360\040\0140\0144\0336\040\0140\0154\0332\040\0141\04\0330\040\0140\0200\0326\040\0140\0164\0300\040\0140\04\0306\0\0340\044\0360\010\0300\0\0360\041\042\0110\0300\050\0300\0\063\0\016\06\0304\06\0142\0274\0360\0\0240\04\0200\0246\040\01\010\0200\0\06\07\0\016\06\0366\0\0240\0210\0364\06\0300\0\020\0200\0\026\0364\040\0342\0270\03\0\016\06\0210\020\0142\070\0310\040\0342\0270\0206\020\0\04\0372\0\0240\0200\0370\07\0100\0\0304\07\0\0\0360\0110\0200\0\0200\0246\040\0\02\0200\0\012\0302\010\0200\0\0302\050\0300\0\0206\0\0340\01\0366\010\0200\0\0265\056\0340\030\0263\076\0240\030\0200\0246\0140\051\022\0277\0377\0366\0204\0\0240\01\0300\050\0300\0\05\0\016\04\07\0\016\05\0260\020\0243\0200\0100\0\02\0277\0223\0350\0340\0150\01\0\0\0\0235\0343\0277\0230\043\0\016\06\0224\020\0\032\0304\04\0142\0274\0302\0\0240\04\0200\0240\0140\01\010\0200\0\027\0340\06\0\0\0306\06\040\010\0200\0240\0340\01\022\0200\0\010\0200\0246\0140\01\0310\0\0240\0274\0225\056\0240\011\0220\020\0\020\0237\0301\0\0\0222\020\040\0\0200\0246\0140\01\022\0200\0\04\0302\04\0142\0274\020\0200\0\03\0302\0\0140\0264\0302\0\0140\0270\0220\020\0\020\0222\020\0\034\0237\0300\0100\0\0224\020\0\033\020\0200\0\014\0320\047\0100\0\0200\0246\0140\01\062\0200\0\03\0302\0\0240\060\0302\0\0240\054\0220\020\0\020\0223\066\0340\011\0237\0300\0100\0\0226\020\0\034\0221\052\040\011\0320\047\0100\0\0201\0307\0340\010\0221\0350\040\0\0235\0343\0277\0230\0340\06\040\04\0222\020\0\033\0220\020\0\034\0262\036\0140\01\0260\020\040\05\0177\0377\0377\0112\0344\04\040\04\0242\020\0\010\0364\044\040\040\0200\0240\0\031\0220\020\0\020\0342\044\040\044\0222\0100\040\0\0366\044\040\050\0302\04\0240\024\0237\0300\0100\0\0222\02\0140\01\0222\020\0\033\0240\020\0\010\0177\0377\0377\0113\0220\020\0\021\0200\0244\040\0\02\0200\0\04\01\0\0\0\0340\047\0100\0\0260\020\040\0\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0230\05\0\016\06\0310\06\040\010\0304\0\0242\0274\0306\01\0\0\0302\0\0240\04\0200\0240\0140\01\010\0200\0\06\0220\020\0\03\0306\0\0240\0260\0237\0300\0300\0\0260\020\040\0\060\0200\0\05\0322\0\0240\050\0237\0302\0100\0\0220\020\0\03\0260\020\040\0\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0220\07\0\016\06\0360\057\0277\0367\0220\020\0\030\0222\07\0277\0367\0304\0\0342\0274\0302\0\0240\04\0200\0240\0140\02\010\0200\0\07\0224\020\040\01\0310\0\0240\0224\0304\0\0240\0270\0237\0300\0200\0\0320\01\0\0\060\0200\0\04\0322\0\0240\0124\0237\0302\0100\0\01\0\0\0\01\0\0\0\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0230\0200\0246\040\012\022\0200\0\04\0220\020\040\015\0177\0377\0377\0347\01\0\0\0\0177\0377\0377\0345\0201\0350\0\0\01\0\0\0\0235\0343\0277\0230\07\0\016\06\0304\0\0342\0274\0302\0\0240\0164\0237\0300\0100\0\01\0\0\0\01\0\0\0\0235\0343\0277\0230\043\0\016\06\0302\04\0142\0114\0200\0240\0140\0\02\0200\0\016\0220\020\0\030\0306\06\040\04\0304\0\0340\020\0237\0300\0200\0\0340\0\0340\034\0320\06\040\064\0200\0242\040\0\042\0200\0\06\0300\044\0142\0114\0177\0377\0377\027\0322\04\040\04\0300\046\040\064\0300\044\0142\0114\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0230\0340\06\040\010\0260\020\040\0\0177\0377\0377\0351\0320\04\040\04\0300\044\040\04\011\077\0372\04\07\0\016\06\0304\01\040\044\0302\0\0342\0110\0302\050\0200\0\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0230\051\0\016\06\0252\020\0\030\0302\05\042\0114\0200\0240\0140\0\022\0200\0\0174\0260\020\040\030\025\077\0372\04\0322\02\0240\014\0340\02\0100\0\0346\04\040\0230\0177\0377\0376\0271\0344\04\0340\034\07\0\016\06\0242\020\0342\0200\0222\020\040\070\0100\0\0\0330\0220\020\0\021\0346\044\0140\04\0306\04\040\0210\0306\044\0140\014\0320\04\040\0214\0320\044\0140\020\0310\04\040\0220\0310\044\0140\024\0304\04\0240\014\0200\0240\0300\02\050\0200\0\07\0322\04\0200\0\027\0\016\04\0100\0\01\0377\0220\022\0343\0230\020\0200\0\0141\0260\020\040\06\0200\0242\0140\0\042\0200\0\0100\0320\04\0240\04\021\0\016\05\0261\050\0340\02\0336\04\0240\020\0324\04\0240\024\0332\02\040\0134\0231\053\0140\02\0200\0242\0100\014\04\0200\0\05\0304\03\0300\030\043\0\016\04\020\0200\0\026\0220\024\0143\0270\03\0\016\06\0232\020\040\0\0330\0\0141\040\0200\0243\0100\014\032\0200\0\015\011\0\016\06\0206\020\040\0\0226\021\040\0250\0210\020\0\013\0340\01\0\0\0200\0244\0\012\02\0200\0\013\0232\03\0140\01\0206\0\0340\014\0200\0243\0100\014\012\0277\0377\0372\0210\01\040\014\045\0\016\04\0222\020\0\012\0220\024\0243\0320\0100\0\0\0327\01\0\0\0\0210\0\0300\013\041\0\016\05\0330\02\040\0134\027\0\016\06\03\074\0\0\025\077\0376\0\0320\01\040\010\0232\02\0\02\0336\04\040\0144\0360\01\040\04\0206\026\0\01\0310\02\0340\0244\0205\073\0100\017\0220\050\0200\012\0202\020\0300\010\0302\0241\0\0200\0222\042\0100\014\0210\01\0\014\0200\0242\0140\0\024\0277\0377\0374\0202\0\0140\01\025\0\016\05\0330\02\0340\0244\0306\02\0240\0140\0226\013\0100\03\0222\023\0\013\0322\044\0140\060\0320\04\0240\04\0200\0242\040\0\042\0200\0\06\0320\04\0240\010\0177\0377\0376\0222\01\0\0\0\0320\044\0140\064\0320\04\0240\010\0200\0242\040\0\042\0200\0\06\0332\04\0340\014\0100\0\0\0111\01\0\0\0\0320\044\0140\010\0332\04\0340\014\0237\0303\0100\0\0220\020\0\021\0200\0242\040\0\042\0200\0\011\0342\045\0140\04\0322\04\0340\030\047\0\016\04\0224\020\0\010\0100\0\01\0244\0220\024\0343\0360\020\0200\0\06\0260\020\040\06\0260\020\040\0\0342\05\042\0114\0252\04\0140\01\0352\045\042\0114\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0230\043\0\016\05\0100\0\0\061\0220\020\040\024\0244\020\0\030\0302\04\0140\0130\0200\0240\0140\0\02\0200\0\023\0240\020\0\010\021\0\016\06\0304\02\042\0274\0310\0\0240\04\0200\0241\040\01\010\0200\0\04\07\0\016\06\020\0200\0\03\0302\0\0240\0254\0302\0\0240\044\0320\0\0342\0270\0237\0300\0100\0\0260\020\040\06\0200\0242\040\0\02\0200\0\012\05\0\016\06\020\0200\0\016\0320\044\0\0\0177\0377\0377\0143\01\0\0\0\0260\0222\040\0\02\0200\0\012\0226\020\040\01\05\0\016\06\07\0\016\05\0220\020\0340\020\0100\0\01\0170\0322\0\0242\0270\020\0200\0\015\0220\020\0\030\0226\020\040\01\025\0\016\06\0326\044\040\010\0322\04\0140\0130\0200\0242\0140\0\02\0200\0\03\0204\022\0240\0174\0204\0\0240\024\0340\044\0240\010\0220\020\040\0\0304\044\0240\04\0201\0307\0340\010\0221\0350\0\010\03\0\016\06\0232\020\040\0\0204\020\0141\044\0210\020\077\0377\0302\0\0141\044\0200\0240\0140\0\02\0200\0\021\0200\0241\077\0377\0306\0\0200\0\0302\0\0300\0\0200\0240\0100\010\052\0200\0\012\0302\0\0340\04\0200\0240\0100\010\02\0200\0\030\0200\0240\0100\04\072\0200\0\05\0302\0\0340\04\0210\020\0\01\0232\020\0\02\0302\0\0340\04\020\0277\0377\0360\0204\0\0340\04\022\0200\0\017\0204\020\0\015\011\0\016\06\0200\0242\040\07\030\0200\0\03\0306\01\041\050\0220\020\040\010\0204\02\040\07\0220\0\0340\010\0204\010\0277\0370\0202\0\0300\02\0232\0\0140\010\0332\041\041\050\020\0200\0\06\0304\040\0300\0\0310\0\0200\0\0220\01\040\010\0306\01\040\04\0306\040\0200\0\0201\0303\0340\010\01\0\0\0\05\0\016\06\0220\02\077\0370\0302\0\0241\044\0302\042\040\04\0201\0303\0340\010\0320\040\0241\044\0224\022\0\011\0200\0212\0240\07\022\0200\0\07\0202\020\0\0\0222\0242\0140\010\066\0277\0377\0377\0300\072\0\011\0201\0303\0340\010\01\0\0\0\0200\0242\0140\017\066\0200\0\07\0200\0212\040\01\0222\0242\0140\01\066\0277\0377\0377\0300\052\0\011\0201\0303\0340\010\01\0\0\0\042\0200\0\06\0200\0212\040\02\0300\052\0\0\0220\02\040\01\0222\042\0140\01\0200\0212\040\02\042\0200\0\06\0200\0212\040\04\0300\062\0\0\0220\02\040\02\0222\042\0140\02\0200\0212\040\04\02\0200\0\05\0222\042\0140\010\0300\042\0\0\0220\02\040\04\0222\042\0140\04\0300\072\0\0\0220\02\040\010\0222\0242\0140\010\066\0277\0377\0376\0300\072\0\0\0200\0212\0140\04\02\0200\0\04\0200\0212\0140\02\0300\042\0\0\0220\02\040\04\02\0200\0\04\0200\0212\0140\01\0300\062\0\0\0220\02\040\02\062\0200\0\02\0300\052\0\0\0201\0303\0340\010\01\0\0\0\0235\0343\0277\0230\05\0\016\06\0362\047\0240\0110\0364\047\0240\0114\0366\047\0240\0120\0370\047\0240\0124\0302\0\0242\0120\0200\0240\0140\0\022\0200\0\05\0372\047\0240\0130\0206\020\040\01\0177\0377\0375\0233\0306\040\0242\0120\0220\020\0\030\0100\0\0\0353\0222\07\0240\0110\021\0\016\05\0100\0\0\0360\0220\022\040\050\0177\0377\0376\0251\01\0\0\0\01\0\0\0\0235\0343\0277\0230\021\0\016\05\0177\0377\0377\0350\0220\022\040\060\01\0\0\0\0235\0343\0277\0210\0240\07\0277\0350\03\0\016\05\0206\020\0140\070\0242\020\0\020\0201\0200\0\0\01\0\0\0\01\0\0\0\01\0\0\0\0220\0166\0100\032\0222\0132\0\032\0204\046\0100\011\0262\0222\040\0\0310\010\0300\02\0310\054\0\0\022\0277\0377\0366\0240\04\040\01\0240\04\077\0377\0237\0306\0\0\0320\0114\0\0\0200\0244\0\021\030\0277\0377\0375\0240\04\077\0377\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0170\0302\0116\0100\0\0200\0240\0140\045\02\0200\0\06\0262\06\0140\01\0220\0220\0140\0\022\0200\0\0271\01\0\0\0\060\0200\0\0273\0242\020\040\0\0340\0116\0100\0\0200\0244\040\0154\02\0200\0\040\0262\06\0140\01\0200\0244\040\0154\024\0200\0\016\0200\0244\040\0163\0200\0244\040\0142\02\0200\0\034\0202\06\0240\04\064\0200\0\04\0200\0244\040\0143\020\0200\0\023\0200\0244\040\0130\02\0200\0\0106\0200\0244\040\0144\042\0200\0\0126\0242\020\0\032\060\0200\0\0233\02\0200\0\0106\0200\0244\040\0163\024\0200\0\010\0200\0244\040\0165\0200\0244\040\0157\02\0200\0\0131\0200\0244\040\0160\02\0200\0\0145\0220\020\040\060\060\0200\0\0221\02\0200\0\0133\0200\0244\040\0170\02\0200\0\0145\0200\0244\0140\01\060\0200\0\0214\020\0277\0377\0336\0242\04\0140\01\0344\06\0200\0\0220\020\0\030\0222\020\0\022\0264\06\0240\010\0340\0\0100\0\0177\0377\0377\0264\0324\0114\0\0\0200\0244\0240\0\042\0277\0377\0314\0302\0116\0100\0\0302\0114\040\01\0242\04\040\02\0200\0240\0140\0\02\0277\0377\0306\0206\020\040\0\0204\0\0177\0377\0220\020\040\01\0211\052\0\02\0200\0214\0200\04\042\0200\0\017\0324\0114\0100\0\0200\0240\0\03\0222\0100\077\0377\0206\012\0140\020\0220\0\0340\054\0237\0306\0\0\01\0\0\0\0320\0114\0100\0\0200\0242\040\040\04\0200\0\012\0206\020\040\01\020\0277\0377\0372\0242\04\0140\01\0324\0114\0100\0\0200\0242\0240\040\044\0200\0\05\0302\0114\0100\0\020\0277\0377\0374\0242\04\0140\01\0302\0114\0100\0\0200\0240\0140\0\022\0277\0377\0346\0242\04\0140\01\0200\0240\0340\0\042\0277\0377\0250\0302\0116\0100\0\020\0200\0\0143\0220\020\040\076\0230\020\0\032\0264\06\0240\04\0326\03\0\0\020\0200\0\0136\0220\012\0340\0177\0236\020\0\032\0264\06\0240\04\0332\03\0300\0\0240\03\0140\01\0320\0113\0100\0\0200\0242\040\0\042\0277\0377\0231\0302\0116\0100\0\0237\0306\0\0\01\0\0\0\0320\0114\0\0\020\0277\0377\0372\0240\04\040\01\0240\06\0240\04\0264\020\0\020\0340\04\0100\0\0200\0244\040\0\066\0200\0\022\0222\020\0\020\0220\020\040\055\0237\0306\0\0\0240\040\0\020\020\0200\0\015\0222\020\0\020\0244\020\0\032\0202\06\0240\04\0264\020\0\01\0220\020\0\030\0224\020\040\010\020\0200\0\063\0322\04\0200\0\0210\020\0\032\0220\06\0240\04\0264\020\0\010\0322\01\0\0\0220\020\0\030\020\0200\0\054\0224\020\040\012\0237\0306\0\0\0242\04\0140\01\0237\0306\0\0\0220\020\040\0170\0200\0244\0140\01\04\0200\0\040\0230\020\0\032\0222\020\0\032\0220\07\0277\0330\0224\020\040\010\0100\0\0\0134\0240\07\0277\0340\05\0\016\05\0264\06\0240\010\0230\020\0240\070\0242\020\0\020\0320\032\0\0\0226\012\0140\017\0233\052\040\034\0237\062\0140\04\0223\062\040\04\0206\023\0100\017\0220\020\0\011\0222\020\0\03\0324\013\0\013\0200\0222\0\03\0324\054\0\0\022\0277\0377\0366\0240\04\040\01\0240\04\077\0377\0237\0306\0\0\0320\0114\0\0\0200\0244\0\021\070\0277\0377\0375\0240\04\077\0377\020\0277\0377\0126\0302\0116\0100\0\0242\06\0240\04\0264\020\0\021\0220\020\0\030\0224\020\040\020\0322\03\0\0\0177\0377\0377\064\01\0\0\0\020\0277\0377\0115\0302\0116\0100\0\0237\0306\0\0\0220\020\040\045\0200\0244\0140\0\02\0200\0\05\0220\020\0\020\0237\0306\0\0\0220\020\040\0154\0220\020\0\020\0237\0306\0\0\01\0\0\0\020\0277\0377\0101\0302\0116\0100\0\0201\0307\0340\010\0201\0350\0\0\0224\020\0\011\0222\020\0\010\021\0\016\02\0220\022\040\0244\0202\023\0300\0\0177\0377\0377\066\0236\020\0100\0\01\0\0\0\0235\0343\0277\0230\021\0\016\02\0222\020\0\030\0362\047\0240\0110\0220\022\040\0244\0224\07\0240\0110\0364\047\0240\0114\0366\047\0240\0120\0370\047\0240\0124\0177\0377\0377\052\0372\047\0240\0130\01\0\0\0\0201\0307\0340\010\0201\0350\0\0\0235\0343\0277\0230\05\0\016\06\011\0\016\06\0302\0\0241\054\0200\0240\0140\0\022\0200\0\014\0260\020\040\010\0326\01\042\0124\021\0\016\05\0206\012\0340\03\0224\022\040\0120\0222\02\0340\01\0320\0112\0200\03\0177\0377\0375\0227\0322\041\042\0124\0177\0377\0375\0225\0201\0350\0\0\01\0\0\0\0201\0307\0340\010\0201\0350\0\0\0200\0242\0240\0\02\0200\0\034\0206\020\0\010\0200\0242\0100\010\032\0200\0\017\0202\02\0277\0377\0222\02\0100\012\0204\020\0\01\0200\0240\0177\0377\02\0200\0\024\0224\02\0\012\0222\02\0177\0377\0224\02\0277\0377\0204\0\0277\0377\0200\0240\0277\0377\0302\012\0100\0\022\0277\0377\0373\0302\052\0200\0\060\0200\0\013\0200\0240\0177\0377\02\0200\0\011\0204\020\0\01\0310\012\0100\0\0204\0\0277\0377\0222\02\0140\01\0200\0240\0277\0377\0310\050\0300\0\022\0277\0377\0373\0206\0\0340\01\0201\0303\0340\010\01\0\0\0\045\0163\072\040\0141\0154\0154\0157\0143\040\0146\0141\0151\0154\0145\0144\0\0\0\0\0\0\0\0\045\0163\072\040\0142\0154\0157\0143\0153\040\0164\0141\0142\0154\0145\040\0143\0157\0162\0162\0165\0160\0164\0\045\0163\072\040\0162\0145\0141\0144\040\0146\0141\0151\0154\0165\0162\0145\0\0\0\0\0\0\0\0\045\0163\072\040\0163\0150\0157\0162\0164\040\0162\0145\0141\0144\0\0\045\0163\072\040\0143\0141\0156\047\0164\040\0157\0160\0145\0156\040\0144\0145\0166\0151\0143\0145\0\0\0\0144\0166\0155\0141\0137\0155\0141\0160\0151\0156\0\0\0\0\0\0\0144\0166\0155\0141\0137\0155\0141\0160\0157\0165\0164\0\0\0\0\0\0160\0162\0157\0155\060\0\0\0\0160\0162\0157\0155\0\0\0\0\076\076\040\0115\0151\0162\0102\0123\0104\040\045\0163\040\060\0101\0101\067\012\0\0\0\0\0\0\0111\0156\0166\0141\0154\0151\0144\040\0143\0157\0156\0164\0162\0157\0154\0154\0145\0162\040\0156\0165\0155\0142\0145\0162\012\0\0\0\0\0\0\0160\0162\0157\0155\0137\0155\0141\0160\0151\0156\072\040\0154\0145\0156\0147\0164\0150\075\045\0144\0\0\0\0160\0162\0157\0155\0137\0155\0141\0160\0151\0156\072\040\0151\0156\0166\0141\0154\0151\0144\040\0155\0141\0160\0164\0171\0160\0145\040\045\0144\0\0\0160\0162\0157\0155\0137\0151\0157\0160\0145\0156\072\040\042\045\0163\042\040\0145\0162\0162\0157\0162\075\045\0144\012\0\0\0\0\0\0\0103\0141\0156\047\0164\040\0157\0160\0145\0156\040\0144\0145\0166\0151\0143\0145\040\0140\045\0163\047\012\0\012\0\0\0\0\0\0\0\0145\0170\0151\0164\0\0\0\0\060\061\062\063\064\065\066\067\070\071\0101\0102\0103\0104\0105\0106\0\0\0\0\0\0\0\0\0174\057\055\0134\0\0\0\0\0\0\0\01\0\0\0\01\0\0\0\01\0\0\0\01\0142\0157\0157\0164\0170\0170\0\0'

# The Block Table
out_int32 $blktblnum
out_int32 $((512 << sscale))
i=0
while (( i < blktblsz )); do
	out_int32 ${blktblent[i++]}
done

# Part 2
print -n '\0\0\0\02\0\070\023\0160\0\070\07\0220\0\070\05\0250\0\070\011\064\0\070\05\0260\0\070\023\0170\0\070\06\0354\0\070\05\0250\0\070\010\04\0\070\05\0260\017\0376\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\01\04\0\0\0\0\0\0\0\0\0\0\02\010\0\0\0\0377\0\0\0\0\0\0\03\010\0\0\0\0377\0377\0\0\0\0\0\04\010\0\0\0\0377\0377\0\0\0\0\0\05\014\0\0\0\0377\0377\0\0\0\0\0\06\010\0\0\0\0377\0\0\0\0\0\0\07\014\0\0\0\0377\0\0\0\0\0\0\010\010\0\0\0\0\0\0\0\0\0\0\011\014\0\0\0\0\0\0\0\0\0\0\012\0\0\0\0\0\070\032\0310\0\0\0\0'
exit 0
