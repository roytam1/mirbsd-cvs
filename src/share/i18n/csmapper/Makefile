# $MirOS: src/share/i18n/csmapper/Makefile,v 1.4 2006/01/31 15:59:29 tg Exp $
# $NetBSD: Makefile,v 1.6 2005/03/27 22:30:06 tnozaki Exp $

NOMAN=

.include <bsd.own.mk>

.SUFFIXES: .src .646 .mps

BINDIR?= /usr/share/i18n/csmapper
SRCS_mapper.dir+= mapper.dir.src
SRCS_charset.pivot+= charset.pivot.src

XSUBDIR= CNS CP EBCDIC GB ISO646 ISO-8859 JIS KS MISC
.for i in ${XSUBDIR}
.  if exists(${.CURDIR}/$i/Makefile.inc)
.    include "${.CURDIR}/$i/Makefile.inc"
.  endif
.endfor

SUBDIR+= mkcsmapper
TOOL_MKCSMAPPER=${.CURDIR}/mkcsmapper/${__objdir}/mkcsmapper

# ----------------------------------------------------------------------

mapper.dir: ${SRCS_mapper.dir}
	${_MKTARGET_CREATE}
	cat $> > $@
mapper.dir.db: mapper.dir
	${_MKTARGET_CREATE}
	${TOOL_MKCSMAPPER} -m -o $@ $>
FILES+= mapper.dir mapper.dir.db
CLEANFILES+= mapper.dir mapper.dir.db

charset.pivot: ${SRCS_charset.pivot}
	${_MKTARGET_CREATE}
	cat $> > $@
charset.pivot.pvdb: charset.pivot
	${_MKTARGET_CREATE}
	${TOOL_MKCSMAPPER} -p -o $@ $>
FILES+= charset.pivot charset.pivot.pvdb
CLEANFILES+= charset.pivot charset.pivot.pvdb

.src.mps:
	${_MKTARGET_CREATE}
	${TOOL_MKCSMAPPER} -o $@ $>

all: _SUBDIRUSE .WAIT ${TOOL_MKCSMAPPER} ${FILES}
realall: ${FILES}

${TOOL_MKCSMAPPER}:
	cd ${.CURDIR}/mkcsmapper && \
	    ${MAKE} CC=${HOSTCC:Q} CFLAGS=${HOSTCFLAGS:M*:Q}

.include <bsd.prog.mk>
