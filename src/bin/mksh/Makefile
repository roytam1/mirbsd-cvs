# $MirOS: src/bin/mksh/Makefile,v 1.25 2007/01/17 23:18:55 tg Exp $

PROG=		mksh
SRCS=		alloc.c edit.c eval.c exec.c expr.c funcs.c histrap.c \
		jobs.c lex.c main.c misc.c shf.c syn.c tree.c var.c
CPPFLAGS+=	-DHAVE_ATTRIBUTE -DHAVE_ATTRIBUTE_BOUNDED -DHAVE_ATTRIBUTE_USED
CPPFLAGS+=	-DHAVE_SYS_PARAM_H -DHAVE_SYS_SYSMACROS_H=0 -DHAVE_LIBGEN_H
CPPFLAGS+=	-DHAVE_STDBOOL_H -DHAVE_RLIM_T
CPPFLAGS+=	-DHAVE_SYS_SIGNAME -DHAVE_SYS_SIGLIST
CPPFLAGS+=	-DHAVE_ARC4RANDOM -DHAVE_ARC4RANDOM_PUSH -DHAVE_SETLOCALE_CTYPE
CPPFLAGS+=	-DHAVE_LANGINFO_CODESET -DHAVE_REVOKE -DHAVE_SETMODE
CPPFLAGS+=	-DHAVE_SETRESUGID -DHAVE_SETGROUPS -DHAVE_STRCASESTR
CPPFLAGS+=	-DHAVE_STRLCPY -DHAVE_MULTI_IDSTRING
CDIAGFLAGS+=	-Wno-cast-qual

LINKS+=		${BINDIR}/${PROG} ${BINDIR}/sh
MLINKS+=	${PROG}.1 sh.1

regress: ${PROG} check.pl check.t
	-rm -rf regress-dir
	mkdir -p regress-dir
	echo export FNORD=666 >regress-dir/.mkshrc
	HOME=$$(readlink -nf regress-dir) perl ${.CURDIR}/check.pl \
	    -s ${.CURDIR}/check.t -v -p ./${PROG} -C pdksh

cleandir: clean-regress

clean-regress:
	-rm -rf regress-dir

.include <bsd.prog.mk>
