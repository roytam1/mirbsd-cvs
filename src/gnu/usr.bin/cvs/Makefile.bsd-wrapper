# $MirOS: src/gnu/usr.bin/cvs/Makefile.bsd-wrapper,v 1.16 2008/10/04 23:13:21 tg Exp $
# $OpenBSD: Makefile.bsd-wrapper,v 1.44 2004/01/02 09:01:24 millert Exp $

# MirOS patchlevel â€“ in sync with MirPorts-6 rev.
FSFMARGS+=	MIROS_BASE_EXTRA_CFLAGS=-D\'PACKAGE_STRINGADD=\"-0AA2\"\'

MAN=		contrib/rcs2log.1 doc/cvs.1 man/cvs.5
INST_TARGET=	INSTALL_MAN= install

CFARGS+=	--prefix=/usr --mandir=/usr/share/man --datadir=/usr/libexec \
		--infodir=/usr/share/info --disable-maintainer-mode \
		--enable-client --enable-password-authenticated-client \
		--enable-server --enable-proxy --enable-case-sensitivity \
		--disable-lock-compatibility --disable-rootcommit \
		--disable-old-info-format-support --with-rsh=/usr/bin/ssh \
		--with-editor=/bin/ed --with-tmpdir=/var/tmp --with-umask=002 \
		--with-cvs-admin-group=_cvsadmin --enable-config-override=no
CFVARS+=	ac_cv_sys_long_file_names=yes
XARGS+=		ZLIB_LIBS=-lz

.include <bsd.own.mk>
COPTS+=		-Wall -Wno-unused
CPPFLAGS+=	-DZCONST=const

.if make(install)
SUBDIR+=	doc/paper
.endif

.if ${.OBJDIR} != ${.CURDIR}
CLEANFILES+=	lib/getdate.c lib/getdate.h
.endif

CVSDIR=		/usr/libexec/cvs/contrib

post-install:
	${INSTALL} ${INSTALL_COPY} -o ${DOCOWN} -g ${DOCGRP} -m ${DOCMODE} \
	    ${.CURDIR}/doc/RCSFILES ${DESTDIR}/usr/share/misc/
	-rm -f ${DESTDIR}${BINDIR}/rcs2log
	ln ${DESTDIR}${CVSDIR}/rcs2log ${DESTDIR}${BINDIR}/rcs2log || \
	    cp ${DESTDIR}${CVSDIR}/rcs2log ${DESTDIR}${BINDIR}/rcs2log

.include <bsd.cfwrap.mk>
