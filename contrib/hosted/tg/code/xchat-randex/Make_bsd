# $MirOS$

CC?=		gcc
CCLD?=		${CC}
CFLAGS?=	-Os -g
LDFLAGS?=
EXTRA_FLAGS?=	-fno-strict-aliasing -fwrapv -fPIC -DPIC

SRCS=		arc4random.c main.c
OBJS=		arc4random.o main.o
LIB=		randex

all: ${LIB}.so

${LIB}.so: ${LIB}.exp ${OBJS}
	${CCLD} -Wl,-O2 -Wl,--version-script,${LIB}.exp \
	    ${CFLAGS} ${EXTRA_FLAGS} -shared ${LDFLAGS} \
	    -Wl,--export-dynamic -o $@ ${OBJS}

.c.o:
	${CC} ${CPPFLAGS} ${CFLAGS} ${EXTRA_FLAGS} -c -o $@ $<
