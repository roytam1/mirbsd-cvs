# $MirOS: ports/voip/iaxcomm/files/BSDmakefile,v 1.3 2005/06/18 00:18:58 tg Exp $

PROG=		iaxcomm
NOMAN=		Yes
DOCDIR=		${PREFIX}/share/doc/iaxcomm
DATADIR=	${PREFIX}/share/iaxcomm

CFLAGS+=	-pthread
LDFLAGS+=	-pthread
CPPFLAGS+=	-DVERSION=\"1.0rc3\" -DDATADIR=\"${DATADIR}\"

WXCFLAGS!=	wx-config --cflags
CFLAGS+=	${WXCFLAGS}

WXLDADD!=	wx-config --libs
LDADD+=		-lm ${WXLDADD}

.include <bsd.own.mk>
.if ${MACHINE_OS} == "Darwin"
CPPFLAGS+=	-DMACOSX
LDADD+=		-framework CoreAudio -framework AudioToolbox

all:
	@echo Look at '$$(PROG).app' target in GNU Makefile and port it.
	@exit 1
.else
CPPFLAGS+=	-DLINUX
GTKCFLAGS!=	gtk-config --cflags
CFLAGS+=	${GTKCFLAGS}
# XXX fix in ports/x11/wxgtk
LDADD+=		-lossaudio -lz -liconv -lgtk -lgdk -lgmodule -lgthread -lglib \
		-lXi -lXext -lX11 -lXinerama -lpng -ljpeg -ltiff -lexpat
.endif

SRCS+=		main.cc prefs.cc calls.cc directory.cc dial.cc frame.cc \
		devices.cc xrc_res.cc accounts.cc ringer.cc
LDADD+=		-liaxclient
XRCS=		rc/devices.xrc rc/directory.xrc rc/frame.xrc \
		rc/menubar.xrc rc/panel.xrc rc/prefs.xrc

xrc_res.cc: $(XRCS)
	wxrc -c $> -o $@

afterinstall:
	${BSD_INSTALL_DATA_DIR} ${DESTDIR}${DOCDIR}
	${BSD_INSTALL_DATA} ${.CURDIR}/QUICKSTART ${DESTDIR}${DOCDIR}/
	${BSD_INSTALL_DATA_DIR} ${DESTDIR}${DATADIR}
	${BSD_INSTALL_DATA} ${.CURDIR}/iaxcomm.htb ${DESTDIR}${DATADIR}/

.include <bsd.prog.mk>
