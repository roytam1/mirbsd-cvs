$MirOS: ports/x11/xloadimage/patches/patch-jpeg_c,v 1.1 2005/09/11 23:45:32 tg Exp $
--- jpeg.c.orig	Sun Oct  1 03:07:18 2006
+++ jpeg.c	Sun Oct  1 03:12:15 2006
@@ -10,6 +10,8 @@
 #include "image.h"	/* xloadimage declarations */
 #ifdef HAVE_LIBJPEG
 #include "options.h"
+#define JPEG_INTERNAL_OPTIONS
+#include <err.h>
 #include <jpeglib.h>
 #include <jerror.h>
 #include <setjmp.h>	/* need setjmp/longjmp */
@@ -225,7 +227,7 @@ jpegLoad (fullname, name, verbose)
 	break;
     default:
 	image = NULL;
-	ERREXITS(&cinfo, 1, "Cannot cope with JPEG image colorspace");
+	errx(1, "Cannot cope with JPEG image colorspace");
     }
 
     row_stride = cinfo.output_width * cinfo.output_components;
@@ -321,8 +323,8 @@ static void parseOptions(j_compress_ptr 
       cinfo->arith_code = TRUE;
 #else
       fprintf(stderr, "jpegDump: sorry, arithmetic coding not supported\n");
-    }
 #endif
+    }
     else if (!strncmp("grayscale", name, strlen(name)) ||
 	     !strncmp("greyscale", name, strlen(name)) ||
 	     !strncmp("monochrome", name, strlen(name))) {
@@ -336,7 +338,7 @@ static void parseOptions(j_compress_ptr 
 #ifdef C_MULTISCAN_FILES_SUPPORTED
       if (verbose)
 	printf("  Creating a noninterleaved file.\n");
-      cinfo->interleave = FALSE;
+/*      cinfo->interleave = FALSE;*/
 #else
       fprintf(stderr, "jpegDump: sorry, multiple-scan support was not compiled\n");
 #endif
