$MirOS$
--- src/icqconf.cc.orig	Sat Oct 28 23:16:57 2006
+++ src/icqconf.cc	Sun Oct 29 01:43:09 2006
@@ -27,6 +27,10 @@
 #include <dirent.h>
 #include <fstream>
 
+#include <nl_types.h>
+#include <langinfo.h>
+#include <locale.h>
+
 #ifdef __sun__
 #include <sys/statvfs.h>
 #endif
@@ -70,6 +74,15 @@ icqconf::icqconf() {
     }
 
     basedir = (string) getenv("HOME") + "/.centericq/";
+
+#ifdef CODESET
+    setlocale(LC_CTYPE, "");
+    if (strcasestr(nl_langinfo(CODESET), "UTF-8") ||
+      strcasestr(nl_langinfo(CODESET), "utf8"))
+	isunicode = true;
+    else
+#endif
+	isunicode = false;
 }
 
 icqconf::~icqconf() {
