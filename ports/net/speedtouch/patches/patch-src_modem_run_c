$MirOS$
--- src/modem_run.c.orig	Thu Jun 10 16:36:13 2004
+++ src/modem_run.c	Sun Jul 25 12:32:19 2004
@@ -1284,7 +1284,7 @@ static void dump(unsigned char *buf, int
 #ifndef USE_SYSLOG
 			fprintf(flog, "%02x ", buf[j]);
 #else
-			sprintf(ptr, "%02x ", buf[j]);
+			snprintf(ptr, (128-(ptr-line)), "%02x ", buf[j]);
 			ptr += 3;
 #endif
 		}
@@ -1293,7 +1293,7 @@ static void dump(unsigned char *buf, int
 #ifndef USE_SYSLOG
 			fprintf(flog, "   ");
 #else
-			sprintf(ptr, "   ");
+			snprintf(ptr, (128-(ptr-line)), "   ");
 			ptr += 3;
 #endif
 		}
@@ -1302,7 +1302,7 @@ static void dump(unsigned char *buf, int
 #ifndef USE_SYSLOG
 			fprintf(flog, "%c", give_char(buf[j]));
 #else
-			sprintf(ptr, "%c", give_char(buf[j]));
+			snprintf(ptr, (128-(ptr-line)), "%c", give_char(buf[j]));
 			ptr++;
 #endif
 		}
