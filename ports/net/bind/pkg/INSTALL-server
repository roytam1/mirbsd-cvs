#!/bin/sh
# $MirOS$
#
# Post-installation setup of BIND 9

PATH=/bin:/usr/bin:/sbin:/usr/sbin
PREFIX=${PREFIX:-/usr/local}
USER=root
GROUP=named
DATADIR=/var/named
EXAMPLESDIR=$PREFIX/share/examples/bind9

notice_existingdir()
{
	echo
	echo "+---------------"
	echo "| You appear to already have a data directory for BIND 9"
	echo "| in $DATADIR. It has been preserved."
	echo "+---------------"
}

create_datadir()
{
	mkdir -p $DATADIR/etc $DATADIR/standard
	cp $EXAMPLESDIR/etc/* $DATADIR/etc
	cp $EXAMPLESDIR/standard/* $DATADIR/standard
	cp $EXAMPLESDIR/etc/named-simple.conf $DATADIR/etc/named.conf
	chgrp -R named $DATADIR
	mkdir -p $DATADIR/dev
}

# Verify/process the command
#
case $2 in 
    PRE-INSTALL)
	;;
    POST-INSTALL)
	if [ -d $DATADIR ]; then
	  notice_existingdir $1
	else
	  create_datadir $1
	fi
	;;
    *)
	echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
	exit 1
	;;  
esac

exit 0
