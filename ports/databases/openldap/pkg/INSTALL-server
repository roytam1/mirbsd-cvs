#!/bin/sh
# $MirOS$

PATH=/bin:/usr/bin:/sbin:/usr/sbin
USER=_slapd
GROUP=_slapd

do_notice()
{
        echo "----------------"
        echo "openldap-server is almost installed"
	echo "----------------"
        echo
	echo "configuration files has been placed in ${PREFIX}/share/examples/openldap"
	echo "it should be configured and placed into ${SYSCONFDIR}/openldap"
	echo "cp -R ${PREFIX}/share/examples/openldap ${SYSCONFDIR}/openldap"
	echo 
	echo "Please create a home for slapd:"
	echo "mkdir -p /var/ldap/{openldap-slurp,openldap-data}"
	echo "chown -R _slapd._slapd /var/ldap/ /etc/openldap/slapd.conf"
	echo "chmod 700 /var/ldap/"
	echo "chmod 600 /etc/openldap/slapd.conf"
	echo 
	echo "To start slapd after reboot, please add this to rc.local"
	echo "if [ -x /usr/local/libexec/slapd ]; then"
	echo "   if [ -e /etc/openldap/slapd.conf ]; then"
        echo "       echo -n ' openldap'; /usr/local/libexec/slapd -u ${USER} -g ${GROUP}" 
	echo "   fi"
	echo "fi"
	echo
        echo "Enjoy openldap!"
}

# verify proper execution
#
if [ $# -ne 2 ]; then
	echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
	exit 1
fi

# Verify/process the command
#
case $2 in
	PRE-INSTALL)
		: nothing to pre-install for this port
		;;
	POST-INSTALL)
		do_notice $1
		;;
	*)
		echo "usage: $0 distname { PRE-INSTALL | POST-INSTALL }" >&2
		exit 1
		;;
esac

exit 0
