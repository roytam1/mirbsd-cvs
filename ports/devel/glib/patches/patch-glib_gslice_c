$MirOS$
--- glib/gslice.c.orig	Sat Sep 30 14:21:15 2006
+++ glib/gslice.c	Thu Mar  6 21:22:01 2008
@@ -101,6 +101,7 @@
 /* --- macros and constants --- */
 #define LARGEALIGNMENT          (256)
 #define P2ALIGNMENT             (2 * sizeof (gsize))                            /* fits 2 pointers (assumed to be 2 * GLIB_SIZEOF_SIZE_T below) */
+#undef ALIGN /* from <machine/param.h> */
 #define ALIGN(size, base)       ((base) * (gsize) (((size) + (base) - 1) / (base)))
 #define NATIVE_MALLOC_PADDING   P2ALIGNMENT                                     /* per-page padding left for native malloc(3) see [1] */
 #define SLAB_INFO_SIZE          P2ALIGN (sizeof (SlabInfo) + NATIVE_MALLOC_PADDING)
@@ -1039,8 +1040,10 @@ slab_allocator_free_chunk (gsize    chun
 }
 
 /* --- memalign implementation --- */
+#if HAVE_MEMALIGN
 #ifdef HAVE_MALLOC_H
 #include <malloc.h>             /* memalign() */
+#endif
 #endif
 
 /* from config.h:
