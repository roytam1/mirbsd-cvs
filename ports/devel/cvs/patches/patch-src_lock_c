$MirOS$
--- src/lock.c.orig	Tue May 24 20:58:39 2005
+++ src/lock.c	Mon Oct  2 04:40:37 2006
@@ -1319,6 +1319,10 @@ internal_lock (struct lock *lock, const 
     lock->repository = Xasprintf ("%s/%s", xrepository, CVSROOTADM);
     lock->free_repository = true;
 
+    /* do nothing if we know it fails anyway */
+    if (readonlyfs)
+      return 0;
+
     /* get the lock dir for our own */
     if (set_lock (lock, 1) != L_OK)
     {
