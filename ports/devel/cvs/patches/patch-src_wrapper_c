$MirOS$
--- src/wrapper.c.orig	Sun Sep  4 00:27:22 2005
+++ src/wrapper.c	Wed Sep 15 19:36:16 2010
@@ -11,6 +11,8 @@
 #include "cvs.h"
 #include "getline.h"
 
+__RCSID("$MirOS$");
+
 /*
   Original Author:  athan@morgan.com <Andrew C. Athan> 2/1/94
   Modified By:      vdemarco@bou.shl.com
@@ -86,7 +88,7 @@ void wrap_setup(void)
        move this to a per-connection data structure, or better yet
        think about a cleaner solution.  */
     static int wrap_setup_already_done = 0;
-    char *homedir;
+    char *homedir = NULL;
 
     if (wrap_setup_already_done != 0)
         return;
@@ -107,6 +109,11 @@ void wrap_setup(void)
 	free (file);
     }
 
+#ifdef SERVER_SUPPORT
+    if (!server_active)
+#endif
+    {
+
     /* Then add entries found in home dir, (if user has one) and file
        exists.  */
     homedir = get_homedir ();
@@ -115,6 +122,8 @@ void wrap_setup(void)
        hand it might be obnoxious to complain when CVS will function
        just fine without .cvswrappers (and many users won't even know what
        .cvswrappers is).  */
+    }
+
     if (homedir != NULL)
     {
 	char *file = strcat_filename_onto_homedir (homedir, CVSDOTWRAPPER);
@@ -338,6 +347,12 @@ wrap_add (char *line, int isTemp)
 
     if (!line || line[0] == '#')
 	return;
+
+    /* Allows user to declare all wrappers null and void */
+    if (line[0] == '!') {
+      wrap_kill ();
+      return;
+    }
 
     memset (&e, 0, sizeof(e));
 
