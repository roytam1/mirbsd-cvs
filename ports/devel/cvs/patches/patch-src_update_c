$MirOS$
--- src/update.c.orig	Thu Sep 22 18:48:55 2005
+++ src/update.c	Wed Sep 15 20:50:45 2010
@@ -51,6 +51,8 @@
 #include "buffer.h"
 #include "hardlink.h"
 
+__RCSID("$MirOS: ports/devel/cvs/patches/patch-src_update_c,v 1.2 2007/03/10 23:53:51 tg Exp $");
+
 static int checkout_file (struct file_info *finfo, Vers_TS *vers_ts,
 				 int adding, int merging, int update_server);
 #ifdef SERVER_SUPPORT
@@ -58,7 +60,7 @@ static void checkout_to_buffer (void *, 
 static int patch_file (struct file_info *finfo,
                        Vers_TS *vers_ts, 
                        int *docheckout, struct stat *file_info,
-                       unsigned char *checksum);
+                       md5_uint32 *checksum);
 static void patch_file_write (void *, const char *, size_t);
 #endif
 static int merge_file (struct file_info *finfo, Vers_TS *vers);
@@ -723,7 +725,7 @@ update_fileproc (void *callerdat, struct
 		{
 		    int docheckout;
 		    struct stat file_info;
-		    unsigned char checksum[16];
+		    md5_uint32 checksum[4];
 
 		    retval = patch_file (finfo,
 					 vers, &docheckout,
@@ -735,7 +737,8 @@ update_fileproc (void *callerdat, struct
 					    (rcs_diff_patches
 					     ? SERVER_RCS_DIFF
 					     : SERVER_PATCHED),
-					    file_info.st_mode, checksum,
+					    file_info.st_mode,
+					    (void *)checksum,
 					    NULL);
 			break;
 		    }
@@ -1197,7 +1200,7 @@ checkout_file (struct file_info *finfo, 
 {
     char *backup;
     int set_time, retval = 0;
-    int status;
+    int status = 0;
     int file_is_dead;
     struct buffer *revbuf;
 
@@ -1511,7 +1514,7 @@ struct patch_file_data
  */
 static int
 patch_file (struct file_info *finfo, Vers_TS *vers_ts, int *docheckout,
-	    struct stat *file_info, unsigned char *checksum)
+	    struct stat *file_info, md5_uint32 *checksum)
 {
     char *backup;
     char *file1;
