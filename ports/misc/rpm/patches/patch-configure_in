$MirOS$
$OpenBSD: patch-configure,v 1.1 2000/12/06 09:45:02 espie Exp $
--- configure.in.orig	Wed Sep 13 19:39:18 2000
+++ configure.in	Fri Jul 11 13:44:29 2008
@@ -341,25 +341,14 @@ AC_CHECK_FUNCS(personality)
 dnl XXX these are needed only by rpmgettext right now
 AM_FUNC_ERROR_AT_LINE
 
-dnl ==> AM_GNU_GETTEXT does this (and more)
-dnl AC_CHECK_HEADERS(unistd.h limits.h locale.h malloc.h string.h sys/param.h)
+AC_CHECK_HEADERS(unistd.h limits.h locale.h malloc.h string.h sys/param.h)
 
-AM_GNU_GETTEXT
-dnl TVM:
-dnl horrible *temporary* hack to make sure that if we found gettext() in
-dnl -lintl that we add -lintl *back* to $LIBS.
-dnl
-if test X$gt_cv_func_gettext_libintl = Xyes ; then
-    LIBS="-lintl $LIBS"
-fi
-
 dnl Checks for header files we can live without.
 AC_HEADER_STDC
 AC_HEADER_MAJOR
 AC_HEADER_DIRENT
 AC_HEADER_TIME
 
-AC_CHECK_HEADERS(db_185.h db1/db.h)
 AC_CHECK_HEADERS(fcntl.h getopt.h grp.h memory.h netdb.h pwd.h utime.h)
 
 AC_CHECK_HEADERS(sys/socket.h sys/select.h)
@@ -374,14 +363,7 @@ AC_CHECK_HEADERS(bzlib.h libio.h zlib.h)
 AC_CHECK_HEADERS(err.h mcheck.h)
 
 dnl whether or not we should try to build rpmgettext/rpmputtext.
-if test X"$USE_NLS" = Xyes; then
-    BUILD_RPMNLSTOOLS="rpmgettext rpmputtext"
-    if test X"$USE_INCLUDED_LIBINTL" = Xyes; then
-	INCPATH="-I\$(top_builddir)/intl $INCPATH"
-    fi
-else
     BUILD_RPMNLSTOOLS=
-fi
 AC_SUBST(BUILD_RPMNLSTOOLS)
 
 AC_CHECK_HEADERS(glob.h)
@@ -907,18 +889,33 @@ AC_SUBST(LIBS)
 
 AC_SUBST(RPM)
 
+case $target in
+*-*-midnightbsd*)
+	RPMBUILD_BASE_CFLAGS='-Os -pipe -Wformat -fno-strict-aliasing -fwrapv'
+	;;
+*-*-mirbsd*)
+	RPMBUILD_BASE_CFLAGS='-Os -pipe -fweb -frename-registers -Wformat -Wstrict-aliasing -Wbounded -fwrapv -fno-align-functions -fno-align-labels -falign-loops=4 -falign-jumps=4 -mpush-args -mpreferred-stack-boundary=2 -fhonour-copts'
+	;;
+*-*-openbsd*)
+	RPMBUILD_BASE_CFLAGS='-Os -pipe -Wformat -Wbounded'
+	;;
+*)
+	RPMBUILD_BASE_CFLAGS='-Os -fno-strict-aliasing'
+	;;
+esac
+AC_SUBST([RPMBUILD_BASE_CFLAGS])
+
 dnl XXX this causes popt to depend on zlib et al
 dnl # XXX Propagate -lucb to popt ...
 dnl export LIBS INCPATH CONFIG_SITE
 
-AC_CONFIG_SUBDIRS(popt)
 AC_OUTPUT([Doxyfile Makefile rpmrc macros platform rpmpopt scripts/brp-redhat
 	lib/Makefile build/Makefile tools/Makefile scripts/Makefile
 	tests/Makefile tests/rpmrc tests/macros tests/hello-test/Makefile
-	misc/Makefile po/Makefile.in intl/Makefile
+	misc/Makefile po/Makefile.in
 	doc/Makefile doc/manual/Makefile
 	doc/ja/Makefile doc/pl/Makefile doc/ru/Makefile doc/sk/Makefile
-	python/Makefile perl/Makefile perl/Makefile.PL],
+	],
 	[echo timestamp > popt/stamp-h.in
 	echo timestamp > stamp-h.in])
 dnl	touch Makefile.in
