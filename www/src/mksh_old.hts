# $MirOS: www/src/mksh_old.hts,v 1.40 2011/05/29 02:28:10 tg Exp $
#-
# This file is part of the website of The MirOS Project, which is
# copyrighted material, please read the LICENCE file for details.

mws_setname subprojects/mksh/old "mksh – old versions"
mws_setheadline The MirBSD Korn Shell
mws_putheader '$MirOS: www/src/mksh_old.hts,v 1.40 2011/05/29 02:28:10 tg Exp $'
mws_content <<'EOF'
<h2><a href="mksh.htm">mksh</a> – old versions</h2>

<p>This page lists information about mksh(1) R37c and earlier.</p>

<h2>Old instructions</h2>
<h3 id="compile">Compilation</h3>
<p>Accepted arguments to <tt>Build.sh</tt> are:</p><ul>
<li><tt>-combine</tt> – all-in-one build, recommended unless gcc is broken;
 ignored if $CC does not support “-fwhole-program --combine” (gcc4, R37+)
 – replaced with “-c combine” from mksh R40</li>
<li><tt>-llvm[=…]</tt> – compile to bytecode; option arguments (or, if none
 given, ‘-std-compile-opts’) are passed to LLVM opt (mksh R36b and up)
 – replaced with “-c llvm” from mksh R40</li>
<li><tt>-valgrind</tt> – append <tt>-DDEBUG -g3 -fno-builtin</tt> which are
 required to work around gcc/valgrind and clang/scan-build bugs (R39b+)
 – replaced with “-g” from mksh R40</li>
<li><tt>-d</tt> (R29 and below): build dynamically, don't try to link with
 <tt>-static</tt> by default on architectures that support it</li>
<li><tt>-nd</tt> (R29 and below): build statically, always try to link with
 <tt>-static</tt> even on systems with nsswitch/PAM</li>
<li><tt>-q</tt> (R35b and below): output almost nothing</li>
<li><tt>-r</tt> (all versions): don't try to build a pre-formatted version
 of the manual page using nroff(1) if found</li>
</ul>
<p>These special values in <tt>CPPFLAGS</tt> are recognised:</p><ul>
<li><tt>-DMKSH_MIDNIGHTBSD01ASH_COMPAT</tt> – parse “--” on the shell command
 line like MidnightBSD 0.1 <tt>/bin/sh</tt> (different from all other shells);
 <em>requires</em> <tt>-DMKSH_BINSHREDUCED</tt> or “-o posix” (R38+) / “-o sh”
 (R39b+)</li>
<li><tt>-DMKSH_BINSHREDUCED</tt> – include code to automatically “set -o
 posix” (mksh R39b+: “set -o sh”) to reduce functionality if called as
 <tt>sh</tt> or <tt>-sh</tt></li>
<li><tt>-DMKSH_NOVI</tt> – omit the Vi command line editing mode, which is
 orphaned anyway, yet functional (mksh below R39b)</li>
<li><tt>-DNO_STRTOD</tt> – (printf.c) disable floating point (below R40)</li>
<li><tt>-DMKSH_AFREE_DEBUG</tt> – run with extra alloc/free checking
 (mksh R36b and below)</li>
<li><tt>-DMKSH_NEED_MKNOD</tt> – if MKSH_SMALL is set, do not omit the mknod(8)
 builtin functionality from the binary; <strong>deprecated</strong>, use the
 environment variable <tt>HAVE_MKNOD=[0|1]</tt> to determine if this builtin
 should be compiled in or not instead; has been removed past R31c</li>
</ul>
<p>The build script also honours the following environment variables:</p><ul>
<li><tt>CPP</tt> ($CC -E -) – the C præprocessor used</li>
</ul>

<h2 id="contrib">Other Shells and more</h2>
<p>mksh is a successor of pdksh but not affiliated with the pdksh
 developers or contributors. mksh is not affiliated with the AT&amp;T
 Korn Shell, its past or present owners, other than that both attempt
 to implement the Korn Shell programming language.</p>
<p>mksh targets users who desire a compact, fast, reliable, secure
 shell not cut off modern extensions; a shell with Unicode support;
 an actively developed, current, and portable product; one with
 developers that listen to their users’ requests and implement them
 if they actually make sense.</p>
<p>mksh aims to replace pdksh in all but very rare use cases (such as
 support for checking the Unix mbox) and in all operating environments
 (thus including patches from pdksh on e.g. Debian).</p>

<h3 id="co-diffs">Differences</h3>
<p>mksh is a direct descendant from the OpenBSD <tt>/bin/ksh</tt> and
 contains all of its bug fixes and enhancements <strong>except</strong>
 the “GNU bash-like <tt>$PS1</tt>” and “POSIX character class support
 in globbing” changes and the incompatible “ulimit can handle multiple
 limits in one invocation” difference. Some of the more weird diffs in
 oksh have not been merged either. The DeliLinux developer who
 is responsible for packaging oksh for GNU/Linux should instead use mksh
 and port that diff over (be careful to not break the fixes to the command
 line editing modes, these are subtilely broken in OpenBSD). Even better,
 the OpenBSD people should not only commit a port of mksh but replace their
 ksh with it (optionally retaining that GNU bash-like $PS1 stuff). The
 <tt>set -o emacs-usemeta</tt> command is no longer needed because the
 emacs editing mode has been changed for Unicode/UTF-8 mode, which adds a
 new <tt>set -o utf8-hack</tt> mode. The <tt>set -o sh</tt> command has
 been completely removed, <tt>set -o posix</tt> merely turns off brace
 expansion as side effect. There is no limit (well, 2³² – for now…) on
 array sizes any more. Many bugs and security holes have been closed in
 mksh and are still in oksh and OpenBSD ksh. The user interface has much
 less bugs and surprises; emacs editing mode is enabled by default.
 In contrast to oksh, <tt>set -o arc4random</tt> can be used to control
 which generator for <tt>$RANDOM</tt> is used.</p>
<p>mksh is the heir of pdksh and contains all the latest fixes from upstream
 (so ca. 1995) and Debian. It is the only pdksh derivate currently being
 under active development. See above for other
 differences. The code really has been cleaned up and no longer contains any
 material under licences more restrictive than the BSD licence.</p>
<p>AT&amp;T ksh88 and ksh93 compare to mksh substantially, but share no code;
 the user interface is slightly different especially for ksh88; many editing
 commands work (only slightly) differently as well. mksh implements many, but
 by far not all, ksh93 features, but most ksh88 features. No floating point.
 All commands of a pipeline are executed in a subshell.</p>
<p>mksh can do many things GNU bash can’t, for example better arrays, the
 ksh Co-processes, etc. but is much faster and smaller. In contrast to bash,
 mksh is still being actively developed (bash almost only receives small
 changes or weird stuff like programmable tab completion). GNU bash’s array
 initialiser syntax is not yet supported. We don’t aim at being fully bash
 compatible, but some of the surprises for converts will be removed. Funnily,
 bash4 now contains some things first introduced in mksh.</p>
<p>The Z shell (zsh) isn’t even remotely ksh compatible in its “emulate ksh”
 operation mode, and we don’t compare to it.</p>
<p>mksh is <em>mostly</em> bourne shell compatible (but ^ as alias for | is
 not supported, like most modern shells). mksh is also POSIX sh compatible.
 Some constructs are not supported, for example<br />
 <tt>((foo; bar) 2>&amp;1 || baz)</tt><br />which has to be rewritten as<br />
 <tt>( (foo; bar) 2>&amp;1 || baz)</tt><br />because ((…)) is shell arithmetics;
 brace expansion is turned on by default; etc.</p>
<p>mksh R33 supports more (later versions even more) bash/ksh93/zsh constructs
 than its predecessors; sometimes, not all cases (e.g. applying string trimming
 on arrays) are supported, but you probably will not notice that.</p>

<h3 id="co-hints">Hints and other useful stuff</h3>
<p>mksh does not write a history file by default any longer; set the
 environent variable <tt>HISTFILE</tt> in <tt>~/.mkshrc</tt> (or the
 profile) if you want this. The history file format of mksh (and oksh
 and pdksh) differs from that of other shells, so you might want to
 use a construct like<br /><tt>case $KSH_VERSION in<br />
 *MIRBSD\ KSH*) export HISTFILE=~/.mksh-history ;;<br />
 *PD\ KSH*MirOS*) export HISTFILE=~/.oldmksh-history ;;<br />
 *PD\ KSH*) export HISTFILE=~/.pdoroksh-history ;;<br />
 ?*) export HISTFILE=~/.ksh-history ;;<br />
 *) export HISTFILE=~/.nonksh-history ;;<br />
 esac</tt><br />to avoid them overwriting each others' history file.</p>
<p>Very old sample: <a href="/cvs.cgi/contrib/samples/etc_profile">this</a></p>
<p>OS inclusion:</p><ul>
<li><a href="http://crux.nu/">Crux GNU/Linux</a> used to have an mksh port contributed by
 <a href="http://www.xs4all.nl/~hanb/software/crux/han/mksh/">Han Boetes</a>.</li>
</ul>

<h2 id="upgrade">For packagers: Upgrades</h2>
<p>mksh R39b now has a separate <a href="#caveat">caveat</a> section listing
 the most relevant user-visible changes, split off this packagers' list.
 The optional, undesirable, unsupported printf(1) builtin is now documented
 in the manpage. The chdir builtin is an alias for cd. The realpath builtin
 is now always provided. <tt>MKSH_SMALL</tt> removes much more functionality
 than it used to. <tt>MKSH_NOVI=1</tt> is now <tt>MKSH_S_NOVI=[0|1]</tt>.
 <tt>$RANDOM</tt> handling is greatly simplified. There's now both “±o sh”
 and “±o posix”, and they differ; <tt>MKSH_MIDNIGHTBSD01ASH_COMPAT</tt> needs
 the former. New build flags <tt>-M</tt>, <tt>-valgrind</tt>. The default on
 HP-UX on IA64 is no longer to default to building with <tt>-mlp64</tt> (gcc)
 or <tt>+DD64</tt> (HP aCC). SUNWcc tries <tt>-xipo</tt> (but requires the
 packager to use <tt>-xO4</tt> or up manually).</p>
<p>mksh R39 has user-visible changes regarding “set -u” (“set -o nounset”)
 and alias/function name conflicts regarding whitespace before parenthesēs,
 as well as a much enhanced <tt>dot.mkshrc</tt> sample file I urge to install.
 People using a Makefile to build it may need to regenerate their set of
 CPPFLAGS used; CPPFLAGS handling in general has improved. There is now a
 defined but unsupported way to make printf(1) a builtin; this is <em>not</em>
 tested and adds a huge SLOB of foreign code to the build, lets the shell use
 stdio and floating point, making it bloated and fragile; if you still want
 it (hi Md), set <tt>USE_PRINTF_BUILTIN=1</tt> and add <tt>printf.c</tt> from
 <tt>mircvs://src/usr.bin/printf/</tt> to the build.</p>
<p>mksh R38c adds QNX fixes, build system fixes, and the (not recommended)
 ability to use <tt>-DMKSH_ASSUME_UTF8=0</tt> to skip the environment checks
 for locale (leading to one (supposedly un-)expected regression test failure).
 Use <tt>-DMKSH_NO_LIMITS</tt> to skip the ulimit builtin (klibc).</p>
<p>mksh R38b works on QNX 6.4 out of the box.</p>
<p>mksh R38 offers <tt>-DMKSH_MIDNIGHTBSD01ASH_COMPAT</tt> and users
 should be warned about the “!string” line and UTF-8 mode changes.</p>
<p>Freshmeat announcements <strong>have ceased</strong> because the
 site switched to a very user-unfriendly HTML (especially Lynx). Use
 the <a href="@@RELPATH@@tag_mksh.rss">RSS feed</a> instead.</p>
<p>mksh R37c now honours <tt>-DMKSH_CONSERVATIVE_FDS</tt> and ACK.
 The regression test suite keeps <tt>LOCPATH</tt> around.</p>
<p>mksh R37b now honours <tt>-DMKSH_UNEMPLOYED</tt> for the jobless
 mode required on, at least, Minix 3.</p>
<p>Freshmeat announcements <strong>have ceased</strong> because the
 site switched to a very user-unfriendly HTML (especially Lynx). Use
 the <a href="@@RELPATH@@tag_mksh.rss">RSS feed</a> instead.</p>
<p>mksh R37 has a new ‘-combine’ <tt>Build.sh</tt> option. The
 <tt>-DMKSH_AFREE_DEBUG</tt> flag is gone due to a new allocator,
 which however honours <tt>-DUSE_REALLOC_MALLOC=0</tt>.</p>
<p>At <a href="http://freshmeat.net/projects/mksh">Freshmeat</a> you can
 subscribe to get automatically notified (with a summary of changes, not
 the complete changelog, see below) whenever new releases are put out.</p>
<p><strong>Note:</strong> This is <em>not</em> <a href="#clog">the
 ChangeLog</a>, these are the packager-visible upgrade notes regarding
 changes in the build system (<tt>Build.sh</tt> and friends, compiler
 support, packaging conventions, bad examples, etc).</p>
<p>mksh R36b stays compatible, no surprises there. The ‘-llvm’ option
 to <tt>Build.sh</tt>, however, is new.</p>
<p>mksh R36’s <tt>Build.sh</tt> script ‘-q’ option is gone. Furthermore,
 you must add <tt>-DMKSH_BINSHREDUCED</tt> to your <tt>CPPFLAGS</tt> now
 if you want mksh to behave more POSIXish if called as <tt>sh</tt>.<br />
 OSF/1 V2.0 is now supported using the native DEC C compiler.</p>
<p>mksh R35b builds on some more platforms and throws less warnings,
 but the build system is almost unchanged; <tt>test.sh</tt> now shows
 the Perl binary used (honours <tt>$PERL</tt>) and its version.</p>
<p>In mksh R35, setlocale/nl_langinfo have been disabled by default for
 some platforms. If we do not assume UTF-8, disabling lets mksh employ
 the <tt>LANG</tt> and <tt>LC_*</tt> environment variables for codeset
 determination. Also, a new builtin is included depending on existence
 of the readlink(3) function, disabled by default if MKSH_SMALL. The
 “pdksh” check category is no longer persistent. The licence has changed
 (the advertising clause was removed). The <tt>dot.mkshrc</tt> sample
 was changed to improve re-use.<br />There was no R34.</p>
<p>No changes in mksh R33c except for Ultrix support. None in R33d.</p>
<p>In mksh R33b, much more compilers are detected, even if not all of
 them are supported. The OE (OS and CC/LD) versions are now dumped too.
 Instead of <tt>#error</tt>, forced link failures are now used as the
 mechanism to auto-detect some things in the target environment. Features
 are now much better detected, and some annoying warnings don’t show up
 any longer due to this. Less tools are required to build.</p>
<p id="tty">Please be reminded that you should run <tt>./test.sh -v</tt>
 inside an environment with <tt>/dev/tty</tt> available (as device node)
 and usable (e.g. use script(1) or GNU screen if you’re doing auto-builds
 detached from controlling terminal). Use <tt>-v</tt> to see failures.</p>
<p>No surprises in mksh R33 either, but the build system now gives more
 detailed output on the version actually built, to aid tracking down
 FTBFSen (build errors) with access to only the build logs. Regression
 tests now work with Intel’s compiler on SLES too, which requires a
 custom <tt>LD_LIBRARY_PATH</tt> formerly stripped by the script.</p>
<p>No surprises in mksh R32, but some ancient systems (AIX, Solaris 11,
 OSF/1, UWIN) are now better supported.</p>
<p>In mksh R31d, parallel make with ‘-j’ was added (no limitation on number
 of childs though), this even works with Solaris 8 <tt>/bin/sh</tt>. The
 <tt>MKSH_NEED_MKNOD</tt> define is no longer honoured.</p>
<p>From mksh R31 to R31b, arc4random.c has been upgraded.</p>
<p>From mksh R30 to R31, there are no surprises. The “arc4random.c” file
 is available from mircvs://contrib/code/Snippets/arc4random.c now, and
 the new “source” command is not available in posix mode either.</p>
<p>From mksh R29 to R30, the following things should be kept in mind:</p>
<p>The syntax of <tt>Build.sh</tt> has changed: $CC now defaults to “cc”
 instead of “gcc”, and the ‘-d’ and ‘-nd’ arguments are gone – if you
 want to build a statically linked mksh, pass <tt>LDSTATIC=-static</tt>
 (gcc+GNU ld, adjust for other OEs) to it. An “arc4random.c” is now
 automatically included into the build if found in the source directory.
 The $CPP variable is ignored, <tt>$CC -E</tt> is used instead, except
 for tcc, which uses “cpp -D__TINYC__” because “tcc -E” doesn’t work.</p>
<p>As a tribute to better POSIX compatibility, certain aliases (like
 “stop”) are no longer predefined in “set -o posix” mode, which is invoked
 automatically if the shell is run as <tt>-sh</tt>, <tt>/bin/sh</tt> or
 similar, so that they can be used as function names.</p>
<p>If defining <tt>MKSH_SMALL</tt>, the ‘vi’ editing mode is omitted,
 which may surprise your users.</p>
<p>Many compilers other than gcc are now supported as well as AIX.</p>

<h2 id="caveat">Users' Upgrade Caveat</h2>
<p id="c39b">R39b: Due to a lot of bugfixes and some enhancements, take
 care when upgrading. The realpath builtin is now always available. There
 are now both “±o sh” and “±o posix”, and they <a href="#r39b">differ</a>
 (scroll down to almost the end of the R39b changelog). In numeric expressions,
 “'a'” is an alternative to “1#a” like in ksh93; “$'…'” expanded strings are
 now also supported. Some constructs parse more loosely, and things like
 “function stop () {” work now. <tt>MKSH_SMALL</tt> removes <em>much</em>
 more functionality than it used to. <tt>set +o arc4random</tt> is no longer
 possible (either it's there and used, or it's not). "mksh /tmp/horsies" now
 exits 127 ipv 1 (ENOENT). 「((foo) || bar)」 and 「((foo) | (bar))」 work
 now. Lazy evaluation of ternary operations is fixed. In '-o sh' mode, echo
 does not expand backslashes any more. In '+o sh' mode, “set -- $(false)”
 POSIXly correctly returns 0 (and breaks getopt(1) in traditional usage
 mode). Changes of variables inside Bourne style functions affect the
 caller's environment. “eval $(false)” also returns 0. “±U” is now honoured
 on an interactive shell's command line. Finally, the getopts builtin now
 behaves standards-compliant: even on an unknown option, <tt>OPTIND</tt>
 is incremented (think “getopts "ab:c" ch” and “script -a -I foo bar” in
 contrast to “script -a -- -I foo bar” – mkdep(1) was <a
 href="http://marc.info/?m=125598551928046">affected</a>, as will be <a
 href="http://marc.info/?m=125598548027997">every script</a> that does not
 abort in the <tt>(\?)</tt> or <tt>(*)</tt> case).</p>
<p id="c39">mksh R39 has user-visible changes regarding “set -u” (“set -o
 nounset”) and alias/function name conflicts regarding whitespace before
 parenthesēs.</p>

<h2 id="clog">Recent Changes</h2>
<p id="r39b">mksh R39b is a major stability and bugfix update:</p><ul>
 <li>[tg] Clean up some more strict *roff or compiler warnings: dashes,
  undefined macros; casting errors (constness, signedness, type width/class)
  and catch possibly unaligned pointer dereferences early; remove code/rodata
  redundancies, plug memory leaks</li>
 <li>[smultron] Tweak the manual page: point out the word “colour”</li>
 <li>[tg] Optimise dot.mkshrc DJB’s CDB hash implementations; add Bob
  Jenkins’ one-at-a-time hash (standard and leading-bit initialised); fix
  signedness in expressions; let the hashes use stdin if "$*" is empty, like
  Lb64{en,de}code; use “[[ -o utf8-mode ]]” ipv “[[ $- = *U* ]]”</li>
 <li>[tg] Build.sh portability fixes: missing prerequisite headers; ensure
  $CC is never called without $CFLAGS; fix <tt>test.sh</tt>, et al.</li>
 <li>[tg] Optimise internal variable representation; use one-at-a-time hash;
  cache hash values for faster resizing at zero memory cost; clean up hash
  table (keytab) code; switch hash table collision resolution algorithm to
  Python’s; prepare for later changes (commented out)</li>
 <li>[tg] Fix type errors in the source code (int → bool, size_t,
  mksh_uari_t)</li>
 <li>[tg] Fix “${foo:bar:$baz}” not working (missing substitute() call)</li>
 <li>[tg] Implement “typeset ±a” as nop</li>
 <li>[tg] Support ksh93-like “${!foo[@]}” listing the <em>keys</em> (indicēs)
  of all set array elements – zsh does it too (${(k)foo}), bash4 can’t :þ</li>
 <li>[tg] Support bash/ksh93-like “array=([key]=value …)” and (additionally)
  “set ±A array -- [key]=value …” to directly specify indicēs to use</li>
 <li>[tg] Document the optional, unsupported, printf(1) builtin in TFM</li>
 <li>[tg] Replace realpath(3) dependency and internally used get_phys_path()
  pdksh code with own implementation; always offer the realpath builtin</li>
 <li>[tg] Implement nameref='typeset -n' (bounded variables) like AT&amp;T
  ksh93 but with mksh-style nested/dynamic scoping and on-use resolving;
  they cannot currently be stored in an array though</li>
 <li>[tg] Add “chdir” builtin doing the same as the “cd” special builtin</li>
 <li>[tg, David Korn] Document more differences between mksh (and pdksh)
  and AT&amp;T ksh (or, more specific, ksh88, ksh93) in the manual page</li>
 <li>[tg] Support “'a'” as an alternative to “1#a”, like ksh93 does</li>
 <li>[tg] Add ksh’s “test -o ?foo”: true if “foo” is a valid shell option,
  where “foo” can be “xtrace” or “-x” or “+x” (these three are equivalent)</li>
 <li>[tg] Support “$'…'” backslash-expanding single-quoted strings, as
  requested by David G. Korn, with almost the same syntax and semantics</li>
 <li>[tg] Unify backslash expansion code (C style vs. print builtin mode)</li>
 <li>[tg] Support “function stop () {” bashism</li>
 <li>[tg] For several items in the source code that require order to be
  kept, provide it from multiply-included header files; sort correctly</li>
 <li>[tg] Get rid of unneeded FMONITOR (-m) for shells without job control;
  sync list of flags, comments and manpage with reality</li>
 <li>[tg] If MKSH_SMALL, reduce size by removing editor functionality</li>
 <li>[tg] Support VT100 emulator style {Ctrl,Alt}-CurLeft/Right keycode
  sequences with new <tt>vt100-hack</tt> emacs bind function (LP: #355883)</li>
 <li>[cnuke, tg] Remove more, like GNU bash extensions, from MKSH_SMALL</li>
 <li>[tg] Remove more functionality, such as Emacs command line editing mode
  bind key macros, and other extensions, from MKSH_SMALL to help floppies</li>
 <li>[tg] Make forking and subshells less expensive wrt. random state</li>
 <li>[tg] Build and source code fixes for / caught by SUNWcc, HP aCC, pcc,
  DEC ucode cc (MIPS), GCC, LLVM clang</li>
 <li>[tg] Make undef/def MKSH_NOVI into 0/1 MKSH_S_NOVI build flag</li>
 <li>[tg] Get rid of "U getenv" in nm(1) output, we already import environ</li>
 <li>[tg] Simplify $RANDOM handling: reads are now either arc4random(3) (if
  available: set +o arc4random is no longer possible) or an LCG; writes are
  arc4random_pushb(3) if available for explicit writes, arc4random_addrandom(3)
  otherwise, or another one-at-a-time hash feeding the LCG; furthermore, RANDOM
  is now always exported to and imported from (implicit read: no push to kernel
  done) the environment vector on startup and spawning</li>
 <li>[tg] Internal code cleanup, optimisation, moves to different files;
  dead/commented out code removal; code beautification</li>
 <li>[tg] Document mksh does not exactly use OPTU-8/OPTU-16 in the manpage,
  as well as when characters, octets, or screen columns are used</li>
 <li>[tg] Fix exit 127 on "mksh /tmp/horsies" ipv of 1 on ENOENT, #548744</li>
 <li>[Clint Adams] Fix typos in the testsuite</li>
 <li>[tg, Clint Adams] Begin a shared testsuite for mksh and posh</li>
 <li>[tg] Make 「((foo) || bar)」 and 「((foo) | (bar))」 work</li>
 <li>[tg] Fix lazy evaluation of assignments by ternary operator, #445651</li>
 <li>[tg] Work around Cygwin bugs (quirks) hindering the testsuite</li>
 <li>[tg] In FSH mode, “echo [-n] 'foo\x40bar'” shall not be expanded</li>
 <li>[tg] Let <tt>Build.sh</tt> run with AIX bsh (SVR3 Bourne Shell)</li>
 <li>[tg] Let <tt>set -- $(false); echo $?</tt> return 0 (POSIXly correct)
  in FSH mode, 1 (needed for getopt(1) support) otherwise</li>
 <li>[tg] Changes of variables inside Bourne style POSIX functions indeed
  affect the current execution environment (of the function caller)</li>
 <li>[tg] Fix getopts behaviour (sync with AT&amp;T ksh93 not ksh88)</li>
 <li>[tg] “eval $(false)” shall return 0 (Debian Closes: #550717)</li>
 <li>[tg] Ensure that <tt>/* apo'strophes in comments */</tt> work</li>
 <li>[tg] New <tt>Build.sh</tt> flag <tt>-M</tt> to not compile but spit out a
  <tt>Makefrag.inc</tt> file from the current build environment, such as the
  (cross)compiler, CFLAGS, LDFLAGS, etc. which then can be sourced by e.g. the
  Android NDK, or built with make(1) – BSD make and GNU make have been tested,
  but almost all makes should work if the source and build directories are the
  same or VPATH is supported at least (use of this option is discouraged)</li>
 <li>[tg] Overhaul and simplify handling of (special) variables</li>
 <li>[tg] Further reduce memory (code/data) and import footprint</li>
 <li>[tg] Use functions without <tt>PATH_MAX</tt> limit on GNU/Hurd</li>
 <li>[tg] Fix tab completing pathnames containing ‘:’, ‘=’, ‘$’ or ‘`’</li>
 <li>[tg] Support ‘-T &lt;tty&gt;’ even if <tt>MKSH_SMALL</tt> and fix it</li>
 <li>[tg] Remove "which" alias "whence -p" to allow "which -a" in
  <tt>dot.mkshrc</tt> and add more examples, some commented out</li>
 <li>[tg] Fix print_columns() issue with displaying items where characters
  had differing number of octets and columns, and the off-by-one which had
  hidden this problem with 2-octet 1-column and 3-octet 2-column chars</li>
 <li>[tg] Beautify the manpage in both AT&amp;T nroff and GNU groff</li>
 <li>[tg] Fix null-expansion of “${x%?}” if <tt>$x</tt> is unset</li>
 <li>[tg] Make some globbing (<tt>${x%?}</tt>) operate on characters instead
  of octets; update manual page to reflect that others still do and remove
  wording that let people think we’d ever support POSuX character classes</li>
 <li>[tg] New <tt>${%foo}</tt> returning width of $foo in screen columns,
  or -1 if $foo contains an ASCII/latin1/Unicode C0/C1 control character</li>
 <li>[tg] Fix subtle possible portability problem wrt. <tt>CHILD_MAX</tt></li>
 <li>[tg] Honour <tt>±U</tt> on command line of an interactive shell</li>
 <li>[tg] Fix dead stores and other bugs pointed out by the Clang static
  analyser; put assertions in places it has false positives (-DDEBUG)</li>
 <li>[tg] Plug uninitialised memory access and possible out-of-bounds read
  of a buffer caught by Valgrind; change one memcpy(3) to memmove(3) where
  srcbuf and dstbuf overlap; place (-DDEBUG) workaround for false positive</li>
 <li>[tg] HP aCC: change IA64 default from forced <tt>+DD64</tt> to using the
  default; support Bundled compiler; fix double-<tt>const</tt> warning</li>
 <li>[tg] Rework <tt>__attribute__</tt> compiler capability check</li>
 <li>[tg] Apply errno save/restore related fix from (sync with) oksh</li>
 <li>[tg] Build.sh: output message when switching from autoconfiguration to
  building / output generation (requested by Matt “lewellyn” Lewandowsky);
  use “conftest.c” ipv “scn.c” (to please ccache); check for “-xipo” with
  SUNWcc (suggested by lewellyn as well)</li>
 <li>[tg] Allow “unset foo[*]” (keep attributes) and “typeset foo[*]” (for
  forward-compatibility; in R39b it’s the same as “typeset foo”)</li>
 <li>[tg] When persistent history is enabled (but not MKSH_SMALL) and used,
  intertwine the shells concurrently accessing $HISTFILE better ⇒ sync on
  empty or duplicate line as well (requested by Maximilian “mxey” Gaß)</li>
 <li>[tg] Split off “set ±o posix” and “set ±o sh” again, to be somewhat
  more compatible to various old or vendor versions of pdksh and mksh:<ul>
   <li>MKSH_BINSHREDUCED sets FSH but not FPOSIX</li>
   <li>MKSH_MIDNIGHTBSD01ASH_COMPAT depends on FSH but not FPOSIX</li>
   <li>The <tt>echo</tt> built-in behaves the same for FPOSIX and FSH</li>
   <li>File descriptors &gt; 2 are not closed for both FPOSIX and FSH</li>
   <li>Both “set -o posix” and “set -o sh” call “set +o braceexpand”</li>
   <li>In contrast to R39 and below, the errorlevel of “set -- $(getopt ab:c
    "$@")” is now the same in ksh and FPOSIX mode (0) and only FSH will use
    the errorlevel of <tt>getopt</tt> (used to be the other way round)</li>
  </ul></li>
 <li>[tg] Document some more shortcomings in the mksh(1) manual page</li>
 <li>Contributed <tt>printf.c</tt> fixes:<ul>
   <li>[tg] Make printf(1) builtin use “$'…'” mode, like ksh93</li>
   <li>[tg] Fix const-cleanliness</li>
  </ul></li>
 <li>Contributed <tt>arc4random.c</tt> fixes:<ul>
   <li>[tg] Fix buffer overflows in the Win32 codepath of the contributed
    <tt>arc4random.c</tt> file and limit the rate of expensive CryptGenRandom
    calls if we have other (seed in registry key) entropy pools</li>
   <li>[tg] Fix uninitialised memory access caught by Valgrind</li>
  </ul></li>
 <li>[tg] New <tt>Build.sh</tt> flag <tt>-valgrind</tt> since I’m lazy</li>
</ul>
<p id="r39">mksh R39 evolved into these through various means:</p><ul>
 <li>[tg] Shut up a bogus gcc warning during configuration process</li>
 <li>[tg] Spell <tt>AT&amp;T</tt> consistently in the source code</li>
 <li>[tg] Tweak mksh(1) manual page, from wbx@ and «lewellyn:#ksh»</li>
 <li>[tg] <tt>dot.mkshrc</tt>: fix <tt>$@</tt> vs. <tt>$*</tt> mix-up</li>
 <li>[tg] <tt>dot.mkshrc</tt>: add DJB cdb hash function</li>
 <li>[tg] Sync with oksh: fix Vi editing mode word erase handling, again</li>
 <li>[tg] Skip whitespace between POSIX style shell function name and its
  definition parenthesēs during detection if an alias of the same name
  already exists to be more robust (Debian Closes: #535970)</li>
 <li>[tg] Build system improvements for ACK and nwcc, both on Debian sid</li>
 <li>[tg] Fix spelling error in changelog discovered by Lintian</li>
 <li>[tg] Aligh “set -o nounset” / “set -u” behaviour with future POSIX
  standard, as discussed with GNU bash maintainers, David Korn from AT&amp;T
  ksh93, and The Open Group; prompted by use in Debian; Closes: #539538</li>
 <li>[tg] add an unsupported way to make printf(1) a builtin</li>
 <li>[tg] Build system and regression test code and comment improvements:
  better and more comments matching reality better; more reliability w.r.t.
  passed CPPFLAGS; more of the MKSH_SMALL changes may be overridden, all of
  them are now enumerated on the webpage; fixed some breakage; portability</li>
 <li>[tg] MKSH_NOPWNAM and MKSH_SMALL will now both disable the <tt>~fac/</tt>
  (homedir) expansion code wholly if defined, not just getpwnam(3) calls</li>
 <li>[tg] shells without job control no longer define the standard “stop” and
  “suspend” aliases (they are pointless anyway); regression tests know</li>
 <li>[tg] use system RCS ID macros on MirBSD if decent enough</li>
 <li>[tg] shut up bogus gcc 4.5/trunk warnings caused by over-optimisation</li>
 <li>[tg] restore ANSI C compilability broken in R38 (speed up, even)</li>
 <li>[tg] use memcpy(3) ipv strlcpy(3) if possible and safe and secure</li>
</ul>
<p id="r38c">mksh R38c contains the following fixes:</p><ul>
 <li>[tg] Fix regression tests on OSes insisting on a shebang (Cygwin)</li>
 <li>[Sean Boudreau] QNX 6.4.2 ed(1) is said to have the bugs fixed</li>
 <li>[tg] <tt>Build.sh</tt> bugfixes: <tt>-DMKSH_BINSHREDUCED</tt> can also
  be given without <tt>-DMKSH_SMALL</tt>; allow <tt>HAVE_REALPATH=x</tt> and
  <tt>HAVE_REVOKE=x</tt> in the environment to re-enable these even if
  <tt>-DMKSH_SMALL</tt> disables them by default, like mknod already did</li>
 <li>[tg] <tt>-DMKSH_ASSUME_UTF8=0</tt> skips the environment checks, like
  <tt>-DMKSH_ASSUME_UTF8=1</tt>, but disables the <tt>utf8-mode</tt></li>
 <li>[tg] Apply some more KNF – style(9) – to the source; clean it up
  and further optimise for small size</li>
 <li>[OpenBSD] Fix segfaults caused by missing check for end of input
  in the tokeniser on “let --” and other input</li>
 <li>[OpenBSD] Make Vi editing mode <tt>^W</tt> behave like Emacs mode’s</li>
 <li>[tg] If no killpg(3) is available, use kill(2) and hope it works</li>
 <li>[tg] <tt>-DMKSH_NO_LIMITS</tt> skips trying to build the ulimit code</li>
</ul>
<p id="r38b">mksh R38b fixes the following problems:</p><ul>
 <li>[André Wösten] Add __NO_EXT_QNX to avoid picking up the wrong
  waitfor() from &lt;libutil.h&gt; in (while porting to) QNX 6.4</li>
 <li>[tg] Plug memory corruption issue introduced in R38</li>
 <li>[tg] Amend <tt>dot.mkshrc</tt> with a base64 en-/decoder in shell</li>
 <li>[tg] Import a manpage fix via OpenBSD from Alan R. S. Bueno</li>
</ul>
<p id="r38">mksh R38 comes with these changes and fixes applied:</p><ul>
 <li>[tg] Improve regression test output debugging</li>
 <li>[tg] Fix &lt;libutil.h&gt; prerequisites on MidnightBSD in mirtoconf</li>
 <li>[tg] Mention that RedHat BZ#496791 cannot currently be fixed in the
  manpage by discouraging use of apostrophes in comments in comsubs; add
  appropriate (expected-fail) regression tests</li>
 <li>[tg] Sync with OpenBSD ksh (mostly a no-op)</li>
 <li>[James Butler] Add search-history-up and search-history-down keybindings
  (tcsh-like) to the Emacs command line editing mode</li>
 <li>[tg] Bind new search-history-{up,down} to ANSI PgUp and PgDn keys</li>
 <li>[tg] Document ANSI default keybindings (↑↓←→ Home End Del PgUp PgDn)
  in the mksh(1) manual page as well</li>
 <li>[tg] Optimise internal UTF-8 handling code for size and reusability</li>
 <li>[tg] Incompatible change: <tt>${foo:1:2}</tt> and <tt>${#foo}</tt> now
  operate on characters, not on bytes. Characters are octets (<tt>set +U</tt>)
  or (utf8-mode) MirOS OPTU-8 multibyte characters (<tt>set -U</tt>)</li>
 <li>[tg] Improve regression tests relating to <tt>${foo:1:2}</tt> and
  <tt>${#foo}</tt> and <tt>let wc=1#x</tt> and utf8-mode</li>
 <li>[tg] Use per-file copyright notices, move global text to manpage</li>
 <li>[tg] Expose new MKSH_MIDNIGHTBSD01ASH_COMPAT ifdef; change it to
  only trigger if FPOSIX (or MKSH_BINSHREDUCED and <tt>/bin/sh</tt>)</li>
 <li>[tg] Remove already-dead “#if 0” style debugging code</li>
 <li>[tg] Change some code into a more portable fashion, optimise</li>
 <li>[tg] Allow <tt>[[ $foo ]]</tt> (ksh93 extension) mentioned by pgas</li>
 <li>[tg] Clean up mksh and the contributed <tt>arc4random.c</tt> for some
  conversion, enum and other warnings for gcc-snapshot trunk r147610</li>
 <li>[tg] Ensure no function uses more than 768 bytes of stack either</li>
 <li>[tg, wbx] Add extension to make “!string” lines work like in GNU bash</li>
</ul>
<p id="r37c">mksh R37c provides these follow-up fixes:</p><ul>
 <li>[tg] Improve præprocessor detection/work in <tt>Build.sh</tt></li>
 <li>[tg] Decouple MKSH_CONSERVATIVE_FDS from MKSH_SMALL</li>
 <li>[tg] Enable MKSH_CONSERVATIVE_FDS by default on Minix 3</li>
 <li>[tg] Work around the (in-)famous ACK "const" bug</li>
 <li>[tg] Optimise structure alignment and padding; Closes: #522778</li>
 <li>[tg] Retain <tt>LOCPATH</tt> (for glibc locale) in <tt>check.pl</tt></li>
 <li>[tg] Document, simplify and clean up the code better</li>
 <li>[tg] Use <i>mirbsd.org</i> eMail addresses consistently</li>
</ul>
<p id="r37b">mksh R37b comes with the following fixes on top:</p><ul>
 <li>[tg] Clean up build system and <tt>dot.mkshrc</tt> some more</li>
 <li>[tg] Add getrusage(2) implementation using times(3) if none found</li>
 <li>[tg] Add jobless mode (for Minix 3, Plan 9, …)</li>
 <li>[tg] Detect the Amsterdam Compiler Kit in the build system</li>
 <li>[tg] If no <tt>RLIM_INFINITY</tt> don’t try to do ulimit</li>
 <li>[tg] Work around gcc4 strict warnings vs. broken system headers</li>
 <li>[tg] Work around systems with mmap(2) but no munmap(2)</li>
 <li>[tg] Fix (disallow) bind key macro recursion (instead of beeping and
  going into an endless loop), allow multi-line bind key macros (mostly
  from Alexander Hall), remove dead code (the beeping) and optimise</li>
 <li>[tg] Add (commented out, undesired, standards compliance breaking)
  compatibility code to MidnightBSD 0.1 <tt>/bin/sh</tt> for ctriv</li>
 <li>[tg] Clarify the mksh(1) manual page even more</li>
 <li>[tg] Port to <a href="http://www.minix3.org/">Minix 3</a> + GCC</li>
</ul>
<p id="r37">mksh R37 has major standards compliance improvements:</p><ul>
 <li>[tg] Rename <tt>-o utf8-hack</tt> to <tt>-o utf8-mode</tt></li>
 <li>[tg] Fix spacing mode error (pasto) in the mdoc(7) format manpage</li>
 <li>[tg] Implement <tt>$((#…))</tt> unsigned arithmetic calculation,
  needed for arc4random_uniform(3)-in-korn-shell implementation</li>
 <li>[tg] Really preserve LD_LIBRARY_PATH in <tt>check.pl</tt></li>
 <li>[tg] New <tt>Build.sh</tt> option ‘-combine’ for building mksh(1) at
  once with “-fwhole-program --combine” (gcc4, llvm-gcc4) if available</li>
 <li>[tg] Always set <tt>COLUMNS</tt> and <tt>LINES</tt> trying as hard
  as we can, using <tt>TIOCGWINSZ</tt> even if used without FTALKING,
  and with the sane 80x24 default if the ioctl(2) fails</li>
 <li>[tg] Handle _POSIX_VDISABLE being undefined (e.g. Linux/klibc)</li>
 <li>[tg] &lt;sys/file.h&gt; is only required for flock(2)</li>
 <li>[tg] Fix multi-column output routine for the corner case if the
  screen is less wide than one output column; 10x Gábor Gergely</li>
 <li>[tg] Fix ${foo/@(%)/\\x} in UTF-8 mode (utf_widthadj for control
  characters U+0080‥U+009F is slightly broken; this fix shifts the
  brokenness into the command line editing mode only)</li>
 <li>[tg] Introduce <tt>mksh_ari_t</tt> and <tt>mksh_uari_t</tt>
  internal types to limit arithmetics to 32 bit on all systems;
  currently depending on the already-used standard <tt>int32_t</tt>
  and <tt>uint32_t</tt> types. Future expansion to 64 bit possible.
  Document that shell integer variables use this type.</li>
 <li>[tg] The variables PGRP, PPID, RANDOM and USER_ID are now unsigned</li>
 <li>[tg] Fix two off-by-ones breaking PS1 ending with a newline; bug
  reported by Matthias Diener</li>
 <li>[tg] Just pass through C1 control characters for now</li>
 <li>[tg] Code and internal interfaces cleanup</li>
 <li>[tg] Regression test fixes for Cygwin env(1) being unsorted</li>
 <li>[tg] Replace the memory allocator by something equally simple
  and homegrown but optimised for use with mksh and free checking</li>
 <li>[tg] Import a couple of minor fixes (e.g. spelling) from oksh</li>
 <li>[tg] Fix problems with "set -e" for real; from oksh, Closes: #518359</li>
 <li>[tg] In "set -o posix" mode, have limited echo(1) to improve
  standards compliance; the exact feature set is open for discussion,
  e.g. with pkgsrc® people; for now, only <tt>-n</tt> as first arg</li>
 <li>[tg] Make test builtin operator precedence consistent; from oksh</li>
 <li>[tg] Revamp and fold and enhance the regression tests</li>
 <li>[tg] Document somewhat surprising behaviour in mksh(1) better;
  here: <tt>[ x -eq y ]</tt>; for gps23 from <tt>#ksh</tt></li>
 <li>[tg] Reduce memory consumption by allocator simplification</li>
 <li>[tg] Fix bugs spotted by DEC ucode cc (ULTRIX) and gcc 1.42 (BSD/OS)</li>
 <li>[laffer1] Make mksh the default <tt>/bin/sh</tt> in MidnightBSD</li>
</ul>
<p id="r36b">mksh R36b is a compatible, major bug-fix update:</p><ul>
 <li>[tg] Add check for naming the output file “scn” instead of “a.out” or
  “a.exe” when compiling scn.c, for Haiku, from Adam “replaced” Hoka</li>
 <li>[tg] Rewrite utf_backch macro and x_bs2 function into a combined
  x_bs3 function for the Emacs editing mode, to optimise them and get
  rid of the use of <tt>__typeof__</tt> (suggested by Anders “ragge”
  Magnusson after the problem was spot by replaced) and one of the uses
  of the statements-as-expressions feature</li>
 <li>[ahoka] Add mirtoconf check for nice(3), missing on Haiku</li>
 <li>[tg] Remove all uses of the statements-as-expressions feature by
  rewriting the source code accordingly and optimising some parts</li>
 <li>[tg] Recognise nwcc (Nils Weller’s C compiler) in <tt>Build.sh</tt></li>
 <li>[tg] If &lt;strings.h&gt; exists, pull it in for strcasecmp(3)</li>
 <li>[tg] Welcome QNX/Neutrino; work around broken <tt>/bin/ed</tt></li>
 <li>[tg] Simplify, shorten, speed up <tt>PS1</tt> in <tt>dot.mkshrc</tt></li>
 <li>[tg] Remove some dead code courtesy of scan-build native runs</li>
 <li>[tg] Add some casts to prevent LLVM+Clang warnings</li>
 <li>[tg] Work around llvm-gcc-4.2.1 -Wformat pickyness</li>
 <li>[tg] Add new <tt>Build.sh</tt> option ‘-llvm’ (clang, llvm-gcc)</li>
 <li>[tg] Speed up mirtoconf if ‘-DMKSH_ASSUME_UTF8’ is set</li>
 <li>[tg] Add the workaround for Debian #492377 into the main mirtoconf
  function (hiding gcc errors during the configure phase) because Gentoo
  has similar scanner issues; reported by Hanno Böck</li>
 <li>[tg] If an MKSH_SMALL has arc4random(3), skip the rand(3)/srand(3)
  fall-back altogether to shrink size, also removed need for time(3)</li>
 <li>[tg] Fix alias expansion recursion check if the word to be expanded
  is immediately followed by end of input, add test case; spotted by
  Michael Hlavinka in pdksh and mksh; RedHat #474115</li>
 <li>[tg] Fix string/wdstring confusion preventing bashiop (&amp;&gt;foo)
  to work inside a function, add regression test, limit to 99 fds</li>
 <li>[tg] change regression tests to <tt>set -U</tt> or <tt>set +U</tt>
  instead of <tt>set -o utf8-{hack,mode}</tt>, as well as query using
  <tt>$-</tt> ipv <tt>$(set +o)</tt> (easier and more reliable)</li>
 <li>[tg] Add comment to regression tests which can fail on slow machines
  or Cygwin environments due to timing issues</li>
 <li>[tg] Remove a lot of superfluous casts, improve type cleanliness</li>
 <li>[tg] Insert a couple of <tt>/* CONSTCOND */</tt> for lint</li>
</ul>
<p id="r36">mksh R36 features the following changes:</p><ul>
 <li>Fix <tt>Build.sh</tt> invocation without ‘-r’, 10x Elias Pipping</li>
 <li>Mention the <strong>MirOS OPTU-8</strong> and <em>MirOS OPTU-16</em>
  encodings in the manual page, now that we have a name for it</li>
 <li>In the MirOS base installation via <tt>Makefile</tt> (and <em>not</em>
  via <tt>Build.sh</tt>, run with <tt>-DMKSH_AFREE_DEBUG</tt> (unless ramdisc
  or MirOS-stable or formal release, i.e. DEBUGLIBS is not set)</li>
 <li>Merge final version of jaredy’s fix for the stack-storage free issue</li>
 <li>Be more efficient in the mksh(1) manual page example section</li>
 <li>Fix multi-line <tt>$PS1</tt> in the (officially orphaned and unsupported)
  “vi” command-line editing mode (regression; reported by asarch via IRC)</li>
 <li>Fix multi-line <tt>$PS1</tt> where the last line is too long for the edit
  area to fit on the screen, genuine (pdksh, probably) bug, while here</li>
 <li>Plug a memory leak; patch from jaredy taken via oksh</li>
 <li>Fix mis-information re. <tt>-o posix</tt> mode in the manual page</li>
 <li>If <tt>-o posix</tt> is set, do not keep file descriptors created via
  I/O redirection, as Korn Shells do, private; add regression test; Debian
  Closes: #499139; reported by Markus Schaber and Agustin Martin Domingo</li>
 <li>Work around GNU getopt(3) violating every single standard in existence
  regarding flag placement on the command line (test suite), from Debian</li>
 <li>Sync internal wcwidth(3) implementation with Markus Kuhn’s latest</li>
 <li>Optimise internal multibyte⇐⇒wide character conversion functions</li>
 <li>Emacs editing mode: if the input line is modified (after a history
  search) or newly typed or empty, preserve it when scrolling the history,
  requested by many (at least: gecko2, Matthias Diener, Benny, myself)</li>
 <li>Do not push lines beginning with an IFS character or IFS white space
  into the history (at the <tt>PS1</tt> prompt only), for Matthias Diener</li>
 <li>Emacs editing mode: if an Escape character ends a history search, and
  Escape is bound to prefix-1, and the following character in prefix-1 mode
  is a prefix-1 or prefix-2 key, do not swallow the Escape character</li>
 <li>Emacs editing mode: new command “edit-line”, bound to <tt>^Xe</tt> by
  default like in lynx(1), allows for interactive editing of the current
  input line similar to Vi mode “v” command, requested by asarch in IRC</li>
 <li><tt>Build.sh</tt>: remove the problematic ‘-q’ option</li>
 <li>Fix internal type abuse: convert more int to bool</li>
 <li>Ignore duplicates when pushing interactive lines into the history,
  prodded by Matthias Diener, wanted by myself for quite a while</li>
 <li>Ignore duplicates after <tt>fc -s</tt> editing too, fix regress test</li>
 <li>&lt;libutil.h&gt; needs &lt;sys/types.h&gt; on some platforms</li>
 <li>Implement somewhat different behaviour for repeated invocations of the
  Emacs prev-hist-word editing command, so that even a single invocation
  trashes “the mark”, but repeated invocations scroll up the history, similar
  to what GNU bash attempts and zsh does, by request of Han Boetes</li>
 <li>Improve support for AIX 5.2 / xlC V7.0, from Jupp “cnuke” Söntgen,
  which does not respect cc -qversion or ld -V (new for improved version
  reporting on AIX 5.3 / xlC V9.0), but also errors out if a static bounds
  checker on arrays is triggered by pointer assignment (such as <tt>p =
  arr[sizeof (arr)];</tt>, even if the only accesses are of the <tt>*--p</tt>
  style, by preventing it from recognising static storage in this case</li>
 <li>Neither AIX has a UTF-8 locale, so disable use of setlocale(3) there</li>
 <li>Fix some of the things the LLVM-Clang scan-build static analyser spotted
  and a couple of compile time warnings</li>
 <li>Reduce amout of stack space eaten, prefer <tt>.bss</tt> storage</li>
 <li>Restore old input line on history search abortion</li>
 <li>(<i>unrelated</i>) update <tt>arc4random.c</tt> sample to allow use of
  arc4random_pushb(3) on GNU/Cygwin by using Microsoft® CryptoAPI</li>
 <li>Bring back automatic <tt>-o posix</tt> setting if the shell is invoked
  as “sh” or “-sh” (unless compiled with MKSH_SMALL), add regression test,
  change it to be only compiled in with <tt>-DMKSH_BINSHREDUCED</tt></li>
 <li>Improve mksh(1) manual page</li>
 <li>Add support for Digital UNIX (DEC OSF/1) V2.0 (MIPS) with DEC C and
  ucode ld, work around a bug by conditionally using static linking</li>
 <li>Change <tt>Build.sh</tt> slightly to accomodate for “true Bourne
  shells” such as OSF/1 V2.0’s <tt>/bin/sh</tt> in printf(1) detection</li>
 <li>Improve OS / compiler / linker version reporting</li>
 <li>Optimise the code and <tt>Build.sh</tt> slightly</li>
 <li>(<i>unrelated</i>) fix <tt>arc4random.c</tt> sample missing defns</li>
 <li>Use the Unicode MirOS Licence template proper in <tt>copyright</tt></li>
</ul>
<p id="r35b">mksh R35b comes with the following bug fixes:</p><ul>
 <li>IRIX also has no UTF-8 locale at all, confirmed by Elias Pipping</li>
 <li>Fix regression test suite for MKSH_SMALL</li>
 <li>Bring in latest changes from oksh (OpenBSD ksh, not DeliLinux crap)</li>
 <li>Fix abuse and unsafe use of str_save() and str_nsave()</li>
 <li>Optimise the implementations of str_save() and str_nsave()</li>
 <li>If MKSH_AFREE_DEBUG is defined, guard against afree()ing a pointer
  which has not been allocated from the given pool, from Todd C. Miller</li>
 <li>Fix attempt to free a pointer to stack (function-local) storage when
  redefining a function containing a call to the “time” built-in, discovered
  by Elias Pipping, patch by Jared Yanovich, help from Todd C. Miller</li>
 <li>Protect a little against people not running “./test.sh -v” but calling
  it with, for instance, GNU bash (as homsn did…)</li>
 <li>Honour <tt>$PERL</tt> environment variable in test.sh, improve scanning
  for Perl, do not use potentially undefined $^O, print Perl version</li>
 <li>Add &lt;sys/types.h&gt; as &lt;ulimit.h&gt; requirement (dietlibc)</li>
 <li>Work around bug in BSD/OS 3.1 /bin/ksh (PD KSH v5.2.8 96/08/19)</li>
 <li>Add regression tests from OpenBSD’s &lt;bsd.regress.mk&gt; suite</li>
 <li>Use better CPPFLAGS for AIX, Minix 3 (from pdksh)</li>
 <li>Expose the “s ≠ NULL” str_[n]save_() API and use it where the string
  can never be NULL (local stack storage), from gcc-4.2 warnings</li>
 <li>Clean up pointer-to-integer-cast warnings in the mirtoconf process</li>
</ul>
<p id="r35">mksh R35 comes with helluva changes:</p><ul>
  <li>Simplify and refactor the ulimit builtin, partially from oksh</li>
 <li>Some style cleanup; use appropriate integer types</li>
 <li>Fix a bug in table (e.g. kill -l, tab completion) display: the width
  of non-ASCII characters is now honoured in the utf8-hack mode</li>
 <li>Improve handling of invalid UTF-8 in certain areas, and multibyte
  (UTF-8 / CESU-8) in general</li>
 <li>When using “typeset -Z«n»” on an integer variable with a base other
  than ten, zero-pad the value instead of the base – pdksh, oksh, zsh, and
  AT&amp;T ksh93 are wrong here; GNU bash doesn’t even have typeset</li>
 <li>Improve parsing of “set +o” output where done (dot.mkshrc, check.t)</li>
 <li>Improve regression tests</li>
 <li>Support for base-1 numbers: in non-utf8-hack mode, ‘1#x’ means the same
  as the ASCII code for ‘x’ (e.g. 78hex), where ‘x’ is any single octet (byte);
  in utf8-hack mode, ‘x’ is <em>either</em> a <strong>valid and minimalistically
  encoded</strong> UTF-8 multibyte character in the range 0000‥FFFD, <em>or</em>
  a single octet <em>with no trailing octets (bytes)</em>, which will then be
  converted as if it were an ASCII value, or, if bit7 is set, be mapped into the
  PUA range of EF80‥EFFF assigned by CSUR for this purpose; this mapping is, in
  both cases, bidirectional; the planned base-0 number support is not possible
  with the code, so use base-1 (with utf8-hack disabled, or &amp; 0xFF) instead
  (while it is recommended to parse only single octets, there is a regression
  test showing correct and safe multibyte parsing, which however is error-prone
  to implement and thusly not recommended) – “genial” replaced@TNG, “this sounds
  fun” ggergely, agreed bsiegert@ and others</li>
 <li>Pull in more current versions of supplied files; use Unicode 5.0</li>
 <li>Clean up unused definitions in build system; document MKSH_CLS_STRING</li>
 <li>Remove advertising clause from <tt>copyright</tt> file; while we’d be
  pleased to be mentioned if something contains our code, tg@ will no longer
  enforce the requirement to advertise with that specific formula, and we’d
  prefer if people remember the OpenHAL vs ath5k incident and that they cannot
  simply change licencing of existing code; patches sent to the MirOS Project
  for inclusion shall be accepted if they’re agreed to match this licence</li>
 <li>Simplify <tt>dot.mkshrc</tt> sample file: licence is merged into the main
  copyright file; AT&amp;T ksh93 compatibility was improved</li>
 <li>Fix a display problem regarding fullwidth characters (e.g. CJK)</li>
 <li>Set the “C” locale in <tt>Build.sh</tt> for tool execution; otherwise,
  certain OEs behave strange; thanks to Adam “replaced” Hoka for spotting</li>
 <li>Use <tt>en_US.utf8</tt> as UTF-8 locale for the testsuite for now</li>
 <li>If <tt>setlocale(LC_CTYPE, "")</tt> is not available, look at the
  environment variables ourselves – brings UTF-8 support to poor OSes</li>
 <li>Remove some now-dead code; speed up configuration process; shrink</li>
 <li>Default to no setlocale(3) due to stubbed or missing locale support
  on GNU/Cygwin, OpenBSD, OSF/1 in <tt>Build.sh</tt>; a few more that are
  quite unlikely to have a UTF-8 locale: BSD/OS, Interix, Minix, PW32, Ultrix,
  AT&amp;T UWIN; default to always UTF-8 on Plan 9</li>
 <li>Fix for testsuite unexpected failure if running as root in one case</li>
 <li>Initialise all shell integer variables (<tt>OPTIND</tt>, <tt>PPID</tt>,
  <tt>RANDOM</tt>, <tt>SECONDS</tt>, <tt>TMOUT</tt>) to base 10</li>
 <li>Reintroduce from mksh pre-R24 shell integer variable <tt>PGRP</tt> set
  to the PID of the process group leader via getpgrp(2)</li>
 <li>New shell integer variable <tt>USER_ID</tt> set to the geteuid(2) and
  used by <tt>dot.mkshrc</tt> to speed up logins, saves a spawn of id(1),
  mentioned by and realisation planned with Andreas "gecko2" Gockel</li>
 <li>Fix <tt>dot.mkshrc</tt> tilde replacement in both <tt>$PS1</tt> and the
  pushd/popd/dirs implementation when the home directory is empty, the root
  directory, or ends with a slash (disable replacement in that case)</li>
 <li>Support dietlibc, force it into providing a BSDish <tt>caddr_t</tt></li>
 <li>Do not use LDFLAGS and LIBS while compiling with <tt>-c</tt></li>
 <li>Add realpath(3) builtin, to further speed up logins and chdirs</li>
 <li>Optimise the code somewhat by making use of possible assumptions</li>
 <li>Set the “C” locale in <tt>test.sh</tt> as well to quell warnings</li>
 <li>Split the regression tests that use locale between <tt>en_US.utf8</tt>
  and <tt>en_US.UTF-8</tt>, since not all OSes support either one, and
  make only HP-UX and GNU use the latter</li>
 <li>Fix kill, mknod(8) builtin usage msg, from Igor Sobrado via oksh</li>
 <li>Use proper <tt>ptrdiff_t</tt> casts for pointer arithmetics, inspired
  by an oksh commit from Federico Schwindt</li>
 <li>Remove check category “pdksh” from <tt>check.t</tt> and test script</li>
 <li>Improve Darwin, OSF/1, HP aCC, SUNpro version reporting</li>
 <li>Support GNU bash “&amp;&gt;” extension, even better than they do,
  suggested by Lukas “smultron” from MidnightBSD</li>
 <li>Basic support for LLVM+clang in the build system with experimental
  “ccc” compiler driver; llvm-gcc worked as-is before already</li>
 <li>Better support for contributed <tt>arc4random.c</tt> file</li>
 <li>Do not spin if unlink(2) fails on $HISTFILE, from Decklin Foster</li>
 <li>Dump the perl(1) <tt>$^O</tt> variable in <tt>test.sh</tt> to logs</li>
 <li>Pull in latest changes from oksh</li>
 <li>Allow white space between a here string indicator and the string,
  accidentally discovered by twkm (#ksh, freenode)</li>
 <li>Allow fd specifications outside the 0‥9 range for I/O redirections,
  and bounds check them to be lower than the <tt>FDBASE</tt> definition,
  currently still 10 if MKSH_SMALL, 24 otherwise (unportable)</li>
 <li>Improve the regression test suite: for one test, we had a bizarre
  constraint telling it won’t work on UWIN, which was based upon false
  assumptions, but Tru64 would fail it since its cat(1) unexpectedly outputs
  some error messages (fix by closing stderr for cat); another test would
  unexpectedly print <em>no</em> error message on Solaris (fix by making
  the error message optional in the perlre(1) used)</li>
 <li>Switch back to en_US.UTF-8 for glibc, Debian can do both, Mandriva
  fails on en_US.utf8 (XXX no libc5 auto-detection to disable it)</li>
</ul>
<p id="r33d">mksh R33d is a quick security-update with these changes:</p><ul>
 <li>Move a portability define from <tt>sh.h</tt> to the <tt>setmode.c</tt>
  helper, as it’s <em>only</em> needed there, and we want to use the latter
  from MirMake as well</li>
 <li>SECURITY: when spawning mksh on a new terminal, for example with
  <tt>sudo mksh -lT/dev/ttyC7</tt>, flush all of that tty’s I/O first</li>
 <li><tt>dot.mkshrc</tt>: ensure “ls” is no alias, don’t hardcode its path</li>
</ul>
<p id="r33c">mksh R33c issues fixes for the following issues:</p><ul>
 <li>Handle Ultrix mmap(2) having a different prototype (returning a
  <tt>caddr_t</tt> instead of a <tt>void *</tt> and not defining
  MAP_FAILED; making Ultrix 4.5 a fully supported platform</li>
 <li>Decrease code size and optimise (using puts-style functions instead
  of printf-style functions for fixed strings; bool instead of int)</li>
 <li>Correct behaviour of “export”, “export -p”, “readonly”, “readonly
  -p”, “typeset”, “typeset -p”, “typeset” and their respective
  descriptions in the manual page; problem reported by Danijel Tasov</li>
 <li>Work around dup2(2) problem (preserving the close-on-exec flag)
  on Ultrix using code from mirbsdksh-1.11, lost in oksh</li>
 <li>Clean up <tt>Build.sh</tt> a little more</li>
 <li>Correct quotes and some other stuff in the regression tests;
  fix for running with old Perl (5.002 or so, Linux 2.0, BSD/OS)</li>
 <li>Export the new “__progname” and “__perlname” environment variables
  to the suite run from <tt>check.t</tt> in <tt>check.pl</tt></li>
 <li>Do not mistake IBM xlC and VisualAge for different things, thanks
  to Pascal “loki” Bleser from OpenSuSE for information on them</li>
</ul>
<p id="r33b">mksh R33b comes with the following minor fixes:</p><ul>
 <li>Work on porting to <a href="http://www.syllable.org/">Syllable</a>
  (again much improved; support now en par with Plan 9’s, thanks to Anthony
  Morphett &lt;awmorp@gmail.com&gt; – maybe the rest is a kernel bug?)</li>
 <li>Fix some minor code issues remarked by MIPSpro</li>
 <li>Port to SGI IRIX 6.5 (uname: IRIX64) using gcc and MIPSpro</li>
 <li>Scan for a lot more compilers; add support for MIPSpro</li>
 <li>Ignore if the OS doesn’t define <tt>MAP_FILE</tt> for mmap(2)</li>
 <li>Use <tt>sys/types.h</tt> as <tt>sys/mkdev.h</tt> dependency</li>
 <li>Enable OSF/1 V2.0 <tt>/bin/sh</tt> to run <tt>Build.sh</tt></li>
 <li>Add strcasecmp(3) proto for Ultrix 4.5 only (imake style)</li>
 <li>Add S_ISLNK if the OS doesn’t define it</li>
 <li>Use tempnam(3) if mkstemp(3) not found – <strong>not recommended</strong></li>
 <li>Reduce dependency on certain OE facilities: printf(1), fgrep(1) being
  able to scan for two patterns at the same time, perl5 being named perl</li>
 <li>New <tt>-T-</tt> option for dæmonisation, cf. man page</li>
 <li>Port to BSDi BSD/OS 3.1 (gcc 1.42 and gcc 2.7.2.1 supported)</li>
 <li>Simplify the <tt>dot.mkshrc</tt> file and make it more robust</li>
 <li>Report OE and <tt>$CC</tt> version in <tt>Build.sh</tt>, for logs</li>
 <li>Fix look’n’feel of the mksh(1) manual page, so that it still looks
  best in AT&amp;T nroff(1), looks much better in GNU groff (the PDF version
  we place on the website), and looks some better <em>and</em> gains the
  ability to copy’n’paste from it for GNU gnroff -Tutf8, originally prompted
  by Patrick “aptituz” Schoenfeld and “lintian -viI mksh*.changes”, but then
  improved (and nroff hacked) by tg@ a lot</li>
 <li>Shut up some gcc warnings (explicit braces; cast <tt>MAP_FAILED</tt>)</li>
 <li>Try to get rid of the test “if the compiler fails correctly” by using
  the errorlevel of the <tt>$CC</tt> process (except with Microsoft Visual C++
  which returns non-zero even on success sometimes), thus supporting DEC C on
  OSF/1 (and, quite possibly, gcc3 on Mac OSX Leopard)</li>
 <li>If revoke(2) and flock(2) are found, check if they’re declared</li>
 <li>Promote Tru64 to a fully supported operating environment, even though it
  needs a plethora of <tt>_*_SOURCE</tt> defines and has <tt>SIGMAX</tt>
  instead of <tt>NSIG</tt>; OSF/1 V4.0 and Tru64 (OSF/1 V5.1) are supported
  with both gcc and HP/Compaq/DEC C in various versions</li>
 <li>Generalise the workaround for incompatible <tt>sig_t</tt> across the
  platforms that need it (currently, OSF/1 and PW32)</li>
 <li>Shut up annoying warning about gcc 2.7.2.3, 2.8.1, 2.95.x not knowing the
  “-std=gnu99” and “-std=c99” options without setting proper errorlevel</li>
</ul>
<p id="r33">A release with many new features is mksh R33, look yourself:</p><ul>
 <li>Sync with OpenBSD ksh (no real functional changes)</li>
 <li>Enhance the <tt>print</tt> builtin with two new escape sequences:
  <tt>\x<b>AB</b></tt> parses the next up to two hexadecimal digits <b>AB</b>
  and outputs a raw octet (byte) whose ordinary value is <b>AB</b>;
  <tt>\u<b>ABCD</b></tt> parses up to four hexadecimal digits and outputs
  the UTF-8 (CESU-8) representation of the unicode codepoint U+<b>ABCD</b>
  from the BMP (Basic Multilingual Plane), not depending on the locale</li>
 <li>The <tt>.</tt> (“dot”) command (and its counterpart <tt>source</tt>)
  needs an argument (the script to source); from Debian pdksh package</li>
 <li>In the lexer, do not expand aliases if there is an opening parenthesis
  just after the token (from Debian pdksh). This fixes the namespace issue
  that caused a POSIX function definition <tt>stop() { … }</tt> to fail due
  to “stop” being a built-in Korn shell alias. Now, aliases are removed when
  a POSIX function with the same name is defined; Korn functions are still
  different: their definition does not fail, but the alias retains its
  precendence (unchanged behaviour)</li>
 <li>Accordingly, do not disable built-in aliases in POSIX mode any more</li>
 <li>Since POSIX mode now only turns off braceexpand mode (which can then
  be turned back on), do not handle being called as <tt>-sh</tt> or <tt>sh</tt>
  specially any longer</li>
 <li>Clean up the source code: make some constants private to the only file
  using it; optimise; comment some code; improve portability with regards to
  stupid tools in /usr/bin (or /usr/xpg4/bin) and foreign compilers</li>
 <li>Implement “here strings” (like ksh93 or zsh; GNU bash collapses white
  space if the string is not double-quoted): you can now replace <tt>print
  -r -- "$foo" | command</tt> with <tt>command &lt;&lt;&lt;"$foo"</tt> with
  the very same semantics as <tt>command &lt;&lt;EOF<br />$foo<br />EOF</tt>
  (stripping initial tabs is not possible)</li>
 <li>Implement string replacement <tt>${var/pattern/string}</tt> (where
  <em>pattern</em> is an extended glob pattern), like GNU bash; like with
  the substring accessor (<tt>${var: x: y}</tt>) mksh implements almost all
  corner cases (and double slash), but do not handle trimming arrays yet</li>
 <li><em>Side note:</em> You can now, as a consequence of the two items
  above, write, for instance, <tt>x=${x//foo*bar/baz}</tt> instead of the
  more complicated <tt>x=$(sed -e 's/foo.*bar/baz/g' &lt;&lt;&lt;"$x")</tt>
  or the mksh R32 and before idiom <tt>x=$(print -r -- "$x" | sed -e
  's/foo.*bar/baz/g')</tt> – be sure to check $KSH_VERSION first though</li>
 <li>Use the new <tt>&#36;Mdocdate&#36;</tt> RCS keyword in the manual page
  mksh(1) as well; since this is not portable in tmac.doc especially to GNU
  groff, prepend a seven-liner implementing it to the <tt>.Dd</tt> macro</li>
 <li>Fix a mistake in using the <tt>.Nm</tt> macro in the manual page</li>
 <li>Make <tt>Build.sh</tt> and the generated <tt>test.sh</tt> more chatty
  about what they’re doing and what versions (aids debugging build logs)</li>
 <li>Update the <tt>dot.mkshrc</tt> sample and make it more portable; it
 requires mksh R33 or above now though due to use of special functions</li>
 <li>Enhance the website, especially the section about official testing:
  now, the tests are split into tests done by us via Makefile (MirOS only),
  Build.sh (portably), porting frameworks, with arc4random.c added, tests by
  others via Build.sh, via packaging frameworks, failed tests; more links</li>
 <li>Note: the “vi” editing mode is code of historical value and, at the
  moment, unmaintained. It does not benefit from the fixes to the “emacs”
  editing mode (horizontal scrolling) or new features (bind keys that end
  their sequence with a tilde; UTF-8 support). Neither is it supported in
  either editing mode to bind keys that generate a sequence consisting of
  more than just a prefix (ESC, ^X, or ESC [), another octet and (“emacs”
  only) an optional tilde (but this might come in the future). This is
  explicitly mentioned here due to a user inquiry.</li>
</ul>
<p id="r32">Sported by mksh R32 are these changes:</p><ul>
 <li>Make checks for symbol declarations compile checks instead of link
  checks, as the binding may not succeed due to different symbol types,
  for instance on AIX, if the declaration does not match</li>
 <li>Widen the range of array indices to [0‥2³²-1], with negative values
  being mapped into the high-bit31 range for simplicity</li>
 <li>Fix the pipeline-as-coprocess internal error</li>
 <li>Do not require certain integer types to be defined any more</li>
 <li>Optimise the code and reduce its RAM usage</li>
</ul>
<p id="r31d">Everyone should upgrade to mksh R31d with fixes for…</p><ul>
 <li>Support pcc (the ragge version of the Portable C Compiler)</li>
 <li>Add pushd/popd/dirs functions (csh) and precmd/chpwd hooks (zsh) to
  <tt>dot.mkshrc</tt> which now requires readlink(1) with <tt>-f</tt>;
  requested by many (e.g. some Gentoo users; XTaran of symlink.ch)</li>
 <li>Enable colour escapes in <tt>dot.mkshrc</tt> since almost nobody groks
  how to do it right from the manual</li>
 <li>Remove <tt>-DMKSH_NEED_MKNOD</tt> checks from <tt>Build.sh</tt>,
  people should use the <tt>HAVE_MKNOD</tt> environment variable</li>
 <li>Implement parallel make in <tt>Build.sh</tt></li>
 <li>Fix another busy-loop spinning problem introduced by an icc warning,
  thanks to spaetzle@freewrt.org for keeping to bug me to look for it, as
  it affected GNU/Linux most, followed by Solaris, rarely BSD</li>
 <li>Improve standard integer type detection in <tt>Build.sh</tt></li>
 <li>Cleanups in code, build script and manual page</li>
</ul>
<p id="r31c">The mksh R31c (Solaris-only) upgrade for cnuke@ was caused by:</p><ul>
 <li>Clean up <tt>Build.sh</tt> and “test … -o …” doesn’t exist in Bourne</li>
 <li>Detect if the non-standard <tt>u_int32_t</tt> type, which was
  unfortunately used by the OpenBSD project in designing the standard
  arc4random(3) API, is present (which it isn’t on Solaris), and, if
  not, emulate it using the standard <tt>uint32_t</tt> (ISO C99) from
  &lt;stdint.h&gt;, which we fake as needed (if the standard integer
  types are not present, e.g. on PW32 and OSF/1); change mksh as well as <a
  href="http://cvs.mirbsd.de/contrib/code/Snippets/arc4random.c?rev=HEAD">the
  arc4random.c contribution</a> to not use these non-standard types</li>
 <li>Remove unused types from the faked &lt;stdint.h&gt; file</li>
</ul>
<p id="r31b">A quick upgrade, mksh R31b with major bug fixes:</p><ul>
 <li>Fix typo (blsk → bksl) in <tt>check.t</tt> test naming</li>
 <li>Autoscan for <tt>uint32_t</tt>, <tt>u_int</tt> etc. presence</li>
 <li>Fix some memory leaks, mostly by NetBSD® via OpenBSD</li>
 <li>The “unset” builtin always returns zero, even if the variable
  was already unset, as per SUSv3 (reported by Arkadiusz Miskiewicz
  via pld-linux → oksh)</li>
 <li>In tab-completion, escape the question mark, reminded by
  cbiere@netbsd.org, via oksh</li>
 <li>Fix a busy-loop problem, Debian #296446 via oksh</li>
 <li>Fix a few display output problems in the build script</li>
 <li>Shut up some gcc warnings on Fedora; beautify some code</li>
 <li>Support OSF/1 with gcc2.8, thanks to Jupp Schugt</li>
 <li>Fix gcc4 detection of __attribute__() on non-SSP targets</li>
</ul>
<p id="r31">mksh R31 was released as part of MirOS #10 with these news:</p><ul>
 <li>Support the TenDRA compiler (possibly also Ten15, not tried)</li>
 <li>Begin supporting Fabrice Bellard’s Tiny C Compiler (tcc on Debian
  cannot link due to duplicate symbols in GNU libc, thus unfinished)</li>
 <li>Improve some mirtoconf checks (most notably, mknod(2) and macros)</li>
 <li>Add new emacs editing command “clear-screen” (<tt>ESC ^L</tt>)
  as requested by D. Adam Karim &lt;archite@midnightbsd.org&gt;</li>
 <li>Support building for MidnightBSD</li>
 <li>Add new shell alias “source”, semantics like the GNU bash builtin</li>
 <li>Add new shell option “set ±o arc4random”, controlling whether rand(3) or
  arc4random(3) is used for the $RANDOM value, use arc4random_pushb(3)</li>
 <li>Add new builtin “rename” (just calls rename(2) on its arguments)</li>
 <li>Fix the inofficial OpenBSD port, from D. Adam “Archite” Karim, 10x</li>
 <li>Disable the less(1) history file by default (privacy issues) in the sample
  <tt>dot.mkshrc</tt> file; mention other things in <tt>etc_profile</tt></li>
 <li>Fix a syntax error in Build.sh checking for TenDRA</li>
</ul>
<p id="r30">A milestone in development: mksh R30 can do this:</p><ul>
 <li>Build on and for Solaris, Linux and MirBSD with Sun’s C compiler</li>
 <li>No longer build a statically linked shell by default; do not try,
  do not provide any means; user has to use LDFLAGS instead</li>
 <li>Remove some probably dead mirtoconf checks</li>
 <li>Remove commented out <tt>-fwhole-program --combine</tt> check and
  still active <tt>-fno-tree-vrp</tt> bug workaround thing, the latter
  because the bug seems to only appear for functions that also exist as
  a builtin (which was declared with the nonnull attribute)</li>
 <li>Fix a long-standing typo, 10x moritz@obsd</li>
 <li>Prefer more common signal names (SIGCHLD) over uncommon ones (SIGCLD)</li>
 <li>Quieten gcc and support SUNpro 5.8 on Solaris 10 on sparc64</li>
 <li>Optimise signal handling and detection; enable compilers whose
  præprocessor doesn’t have <tt>-dD</tt> to generate list of signals</li>
 <li>Optimise mirtoconf meta-checks for persistent history etc.</li>
 <li>Fix a bug preventing manual page generation on Solaris</li>
 <li>Add support for the Intel® C Compiler and quieten it a little; fix a few
  minor buglets (mostly type conversion) its too verbose warnings show, as
  well as some errno ab-/mis-use</li>
 <li>Remove support for honouring the <tt>CPP</tt> environment variable;
  <tt>$CC -E -</tt> is simply used instead in the places where <tt>$CPP</tt>
  was used previously, because that was used in other places already, and
  to prevent it from behaving differently from the $CC used</li>
 <li>If a file called <tt>arc4random.c</tt> is lying around in the source
  directory at mirtoconf time, scan for <tt>&lt;sys/sysctl.h&gt;</tt> and
  use the file if arc4random(3) isn’t found otherwise. From Debian.</li>
 <li>If the basename of argv[0] starts with “sh”, activate FPOSIX
  early, preventing some typical ksh aliases from being defined</li>
 <li>If FPOSIX, don’t pre-define aliases (except integer and local) to benefit
  operating environments that never heard of the great Korn Shell…</li>
 <li>#if defined(MKSH_SMALL) || defined(MKSH_NOVI) disable the vi
  editing mode</li>
 <li>Don’t try to execute ELF, a.out, COFF, gzip or MZ binaries</li>
 <li>Can be built on HP-UX (PA-RISC and IA64) with gcc or HP C/aC++</li>
 <li>Support <tt>x=(a b c)</tt> bash-like array initialisation</li>
 <li>Support <tt>${foo:2:3}</tt> bash-like substring expansion</li>
 <li>Many mirtoconf improvements, fixes; speed-up; better portability</li>
 <li>Enable compilation using Microsoft C/C++ Standard Compiler</li>
 <li>Add UWIN build target using various compilers with the cc wrapper</li>
 <li>Fix struct padding mistakes uncovered by the Microsoft compiler</li>
 <li>Fix double initialisation / unused value assignment errors unveiled
  by Borland C++ Builder 5.5</li>
 <li>Fix superfluous code detected by gcc 4.2</li>
 <li>Fix large file support for OSes that require CPPFLAGS contains
  <tt>-D_FILE_OFFSET_BITS=64</tt> – it was detected but not actually
  used in the build; thanks to hondza for the problem report!</li>
 <li>Give the lexer a bigger state stack if !MKSH_SMALL</li>
 <li>Prepare for addition of make(1)-style search/replace operations;
  correct the code for other substitution expansion operations</li>
 <li>Default $CC to cc not gcc, this is no non-unix-ware ☺</li>
 <li>Support AIX with gcc and xlC; clean up code to warning-free</li>
 <li>Prefer well-known signal names to alphabetically earlier ones</li>
 <li>Fix a bug delivering ERR and EXIT pseudo-signals to traps combined
  with “set -e”, thanks Clint Pachl and Otto Moerbeek for the hint</li>
</ul>
<p>In mksh R29g we MFCd the following changes:</p><ul>
 <li>Some optimisations from above; no longer execute foreign objects</li>
 <li>Improvements in checking for __attribute__, multi-idstring support,
  signals, types, arc4random.c; disable -fno-tree-vrp and -fwhole-program
  --combine; correct large file support (still kludgy but no longer buggy)</li>
</ul>
<p>Please use mksh R29f because of below modifications:</p><ul>
 <li>Fix detection of function prototypes (data declaractions were ok)</li>
 <li>Fix a regression introduced in R29e regarding the scroll bar</li>
 <li>Recommendation on <a href="#vsn">version numbering</a> changed;
  suffixes b, c, … match .2, .3, … like alphabetical numbering order</li>
</ul>
<p>Dedicated to David Ramsey and Coverity, mksh R29e unveils:</p><ul>
 <li>Don't poll in strcasestr(3) if setlocale(3) isn't used</li>
 <li>Remove some redundant or unused functions</li>
 <li>Fix a horizontal scrolling on tabcomplete bug, reported by David
  Ramsey, thanks a lot!</li>
 <li>Fix the utf8bom-3 regression test on MirBSD-current</li>
 <li>Some workarounds around problems found by Coverity Scan, mostly
  issues with Scan, but the changes help gcc to optimise better</li>
 <li>Fix a null pointer dereference in error path, mis-use of strchr(3)
  to search for a NUL byte, and two possible out-of-bounds array
  accesses, found by Coverity Scan, many thanks!</li>
 <li>Optimise <tt>dot.mkshrc</tt> further</li>
 <li>Fix a cursor mis-positioning on backspace bug, reported by David
  Ramsey again, thanks!</li>
 <li>Fix a scrollbar mis-display on delete bug, reported by David Ramsey</li>
 <li>Fix a scrollbar mis-display on insertion bug, discovered while
  fixing the above bug</li>
 <li>Correct displaying of scrollbar on delete, with help from dramsey</li>
</ul>
<p>Portability improvements in mksh R29d contain:</p><ul>
 <li>Unbreak testsuite on Mac OSX (whose brain-dead file system does
  non-standard Unicode decomposing and normalisation on filenames,
  thus rendering ANOTHER of our tests unusable *sigh*)</li>
 <li>Port to AIX, thanks to Kurt Telep</li>
 <li>Minor fixes for HP-UX, thanks to HP Testdrive Programme</li>
 <li>size optimisation if utf-8 is assumed to be always on</li>
 <li>Do not scan for and use “-fwhole-program --combine” because it's the
  cause of at least http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=408850
  and breakage with FORTIFY_SOURCE on SuSE; thanks to Pascal Bleser (yaloki),
  Marcus Rückert (darix), Martin Zobel-Helas, Steve Langasek (vorlon) for
  tracking this bug down in two different places; Closes: Debian #421518</li>
 <li>small manual page fixes</li>
 <li>copy $PATH from Build.sh to test.sh; thanks to a test account on Sun
  Solaris 11 donated by Julian Wiesener (yofuh) I was able to verify that
  you want to prefix $PATH with <tt>/usr/xpg4/bin</tt> because the other
  tools (<tt>/usr/bin</tt>, <tt>/usr/ccs</tt>, et al.) suck major arse…</li>
 <li>Note: the SuSE package in the Buildservice was created by darix (without
  my knowledge), is maintained by loki now</li>
 <li>Note: the PDF manual page is now PDF 1.3 (Acrobat 4.x) again</li>
</ul>
<p>Minor bugfixes in mksh R29c – you might want it:</p><ul>
 <li>Regression fix: mksh has some kind of “encoded string” format;
  use wdcopy() not str_save() to duplicate this; affects formatting of
  an error message (and below item) only though</li>
 <li>Bugfix: pdksh has an out-of-bounds memory access; the area of code
  has been touched by OpenBSD developers but the problem not fixed by
  them; some optimisations turned this (for the error message formatting
  of the above item) into a memory corruption bug that was <em>only</em>
  triggering an actual issue on Debian GNU/Linux experimental on IA-64
  with some beta version of GNU glibc; add an appropriate bounds check</li>
 <li>Add mirtoconf check for “large file support” needed on some obscure
  platforms; requested by bsiegert@, idea from GNU autoconf (thanks)</li>
 <li>Add zsh workaround to Build.sh (just to be on the safe side; zsh
  isn't bourne sh or posix sh compatible, but I didn't find any severe
  problems with using it to build mksh yet, it's a weird shell though)</li>
 <li>If execve(2) fails with ENOEXEC, try and parse a shebang line
  ourselves, in case the kernel can do less than we do, unless MKSH_SMALL</li>
 <li>Strip off and ignore an UTF-8 Byte Order Mark (U+FEFF, 0xEF 0xBB 0xBF)
  at the beginning of input (file, -c option, stdin, interactive, eval)
  and when processing shebang lines and enable utf8 mode if encountered</li>
 <li>Enhancements to the <tt>dot.mkshrc</tt> file, whose status (in MirBSD
  itself) is now upgraded from “sample file for portable mksh to show off to
  other OSes” to “used as skeleton file in the default installation” – gets
  us rid of duplicating this stuff in /etc/profile (MirBSD native) a̲n̲d̲ makes
  sure that users of portable mksh also have the latest goodies</li>
 <li>When doing shebang parsing, accept not only LF and NUL but also CR as
  markers for end of the (first) line</li>
 <li>If executing fails, tell the user what exactly failed, too</li>
</ul>
<p>Immediately upgrade to mksh R29b please:</p><ul>
 <li>Bugfix: display UTF-8 control characters (U+0080..U+009F, i.e.
  everything with a wcwidth(3) of -1) the same as ASCII control
  characters (U+0001..U+001F), i.e. with a ctrl caret followed by
  its value XOR U+0040; subsequently treat their width as 2;
  fix crash (CPU hog in spinning loop) on meta-tab+backspace</li>
 <li>Fix setlocale description in manual page</li>
 <li>in the utf-8 mode, invalid multibytes are now handled more strictly:<ul>
   <li>if it's in x_literal() (“quote” / ^V) mode, it's accepted like now</li>
   <li>if it's a mb sequence start, it's rejected with a beep</li>
   <li>if it's a mb continuation, the whole sequence is silently rejected</li>
  </ul>
  This makes command line editing when accidentally hitting, e.g. with
  my mircvs://contrib/samples/dot.Xmodmap layout, Mode_switch-x much
  more robust.</li>
 <li>remove unused utf_width() macro</li>
 <li>if $CC supports -fstack-protector-all, add it to CFLAGS</li>
 <li>shut up some more gcc 4.1.2 warnings</li>
 <li>if $CC supports -fno-tree-vrp and is subject to the <a
  href="http://gcc.gnu.org/bugzilla/show_bug.cgi?id=30785">null pointer
  test optimised away</a> bug, use -fno-tree-vrp to work around it</li>
 <li>in Build.sh, simplify a.out / a.exe (Cygwin) issues</li>
 <li>shrink the manual page to 39 pages sized DIN A4 when built as PS/PDF</li>
 <li>fix a typo in the manual page</li>
</ul>
<p>Please upgrade to mksh R29 due to the following changes:</p><ul>
 <li>Fix portability of regression tests using fgrep(1), twice</li>
 <li>Fix description of $RANDOM in manual page</li>
 <li>Fix build under OpenSolaris Build 47 (reported in IRC)</li>
 <li>Use easier __RCSID() stuff from MirOS #9-current</li>
 <li>Don't shebang with spaces in test.sh creation</li>
 <li>Remove -fno-strength-reduce from default CFLAGS, the compiler bug
  was fixed between gcc 2.7.2 and gcc 2.7.2.1&#8230;</li>
 <li>Avoid unaligned memory access causing SIGBUS on IA-64 on Debian</li>
 <li>Convert to autoconf-style check for function and header file existence
  of &lt;sys/param.h&gt;, arc4random(3), arc4random_push(3),
  setlocale(3) and LC_CTYPE, nl_langinfo(3) and CODESET, getmode(3) and
  setmode(3), strcasestr(3), and strlcpy(3)</li>
 <li>Add <tt>set -o utf8-hack</tt> aka <tt>mksh -U</tt> which
  changes the Emacs editing mode to an experimental CESU-8 aware
  multibyte mode (not implemented using wide chars unless internally
  needed; does not require OS support); check setlocale(LC_CTYPE, "")
  and nl_langinfo(CODESET) if found to auto-enable utf-8 mode
  in interactive shells</li>
 <li>Simplify and clean up code; try to remove or replace function calls
  by smaller equivalents; spot a few non-fatal off-by-one errors</li>
 <li>If Build.sh is called with <tt>-DMKSH_SMALL</tt> in the CPPFLAGS
  environment variable, the built-in mknod(8) will not be included,
  and other functionality and verbose usage messages will be excluded;
  some macros will be turned into functions to save space and to check
  if the utf8-hack should be enabled, nl_langinfo(3) is not called.
  The -T option to mksh(1) and persistent history are not supported.</li>
 <li>Hand-optimise the code to be small, even in the normal build</li>
 <li>Unbreak the -d option to <tt>Build.sh</tt></li>
 <li>Check for <tt>cc</tt> options -Wno-error, -fwhole-program --combine,
  and (if MKSH_SMALL) -fno-inline and use them if they don't fail</li>
 <li>The autoconf-style (&#8220;mirtoconf&#8221;) checks have been enhanced,
  improved and be made more verbose by default</li>
 <li>Rewrite a few functions both to save space and to simplify/unify
  the code; also spotted a few bugs in existing (inherited) code</li>
 <li>Fix format string mistakes and wrong function and data prototypes</li>
 <li>Correct zero-padding for right-justified strings; add regression test</li>
 <li>EXECSHELL is now ${EXECSHELL:-/bin/sh} again</li>
 <li>Remove duplicate code if feasible; rewrite remaining code to solve
  all use cases, or use standard library functions such as qsort(3);
  rework the ctypes and chtypes stuff, get rid of libc/ctype.h</li>
 <li>Change the eaccess() code to not use setreuid(2) and friends, like
  OpenBSD ksh and apparently pdksh. I'm not too sure about the implications,
  except that they only affect setuid shell scripts.</li>
 <li>Use setresuid(2) and friends, and setgroups(2) and &lt;grp.h&gt; instead
  of seteuid(2), setuid(2) etc. on operating systems that support them</li>
 <li>Work around (i.e. remove) all but two <tt>-Wcast-qual</tt> issues</li>
 <li>Work around a bug in the GNU implementation of the Berkeley mdoc macros
  which comes with GNU groff (only visible in MirOS with groff -mgdoc, but
  shows on other operating systems), discovered by crib in IRC</li>
 <li><tt>$RANDOM</tt> is always an unsigned 15-bit decimal integer, for all
  Korn shell derivates; idea from twkm in IRC</li>
 <li>Improve/correct description of typeset command in manpage, and
  implementation of <tt>typeset -p</tt> in mksh</li>
 <li>Remove the non-standard emacs-usemeta and vi-show8 shell options,
  assume the user either has a 7-bit environment, an 8-bit clean terminal,
  or a UTF-8 environment (preferred), and the dummy sh option</li>
 <li>Build.sh fix for conservative (old) versions of gcc; help Debian</li>
 <li>Compute user-given ulimit value times ulimit unit as an rlim_t value,
  not as long value; catches some 32 bit overflows on 32 bit platforms
  due to a missing cast</li>
 <li>Fix some typos in the manual page</li>
 <li>Build.sh add notes for old and non-gcc compilers (TODO)</li>
 <li>Upgrade licence to latest template (revision 1.20)</li>
 <li>Fix reverse logic error in strcasecmp(3) vs strcasestr(3) issue</li>
 <li>Enhance sample ~/.mkshrc</li>
 <li>Prevent segfaults when setlocale(3) or nl_langinfo(3) return NULL</li>
 <li>Use RLIMIT_AS if RLIMIT_VMEM is not found</li>
 <li>Don't expand <tt>~foo/</tt> if MKSH_SMALL, spares getpwnam(3) call</li>
 <li>Fix and autoconfify signal list generation</li>
 <li>Build.sh now uses $TARGET_OS as "uname -s" output for cross builds</li>
 <li>Set flag for regression tests that can't succeed if MKSH_SMALL</li>
 <li>Don't even check for setlocale(3) if MKSH_SMALL, unless overridden
  by user / build environment</li>
 <li>Scan for C Preprocessor, use $CPP if $CC -E fails</li>
 <li>Fix possible nil pointer dereferences and signal name mismatches</li>
 <li>Scan for __attribute__((...)) and -std=gnu99 (req'd on Solaris 10)</li>
 <li>Correct $LDSTATIC logic, unbreak -d, don't let the user override
  (or need to) $SRCS, $sigseen</li>
 <li>Simplify TIOCGWINSZ handling, no need to catch SIGWINCH any more;
  window size changes are processed after input line editing ends (i.e.
  the lines are entered or <tt>ESC #</tt> (emacs mode) is pressed) and
  at startup; ^L (redraw) can't change window size on the fly</li>
 <li>Add -fwrapv to standard CFLAGS, just to be safe, like with when I
  added -fno-strict-aliasing; this is pending a bug fix in gcc, see <a
  href="http://gcc.gnu.org/bugzilla/show_bug.cgi?id=30477">PR#30477</a></li>
 <li>autoconfify compiler flags, c preprocessor</li>
 <li>add option to avoid pulling in getpwnam(3) in !MKSH_SMALL</li>
 <li>scan for certain headers, types; improve portability</li>
 <li>speed up autoconfiguration process in failure case</li>
 <li>finally fix static vs dynamic linking issues</li>
 <li>fix manpage (.Nm macro) glitch with GNU nroff 1.15</li>
 <li>improve auto-detection of which regression tests are valid</li>
 <li>mention failure to revoke(2) is possibly insecure</li>
 <li>if MKSH_SMALL, don't include -T support and don't scan
  for revoke() function</li>
 <li>new #ifdef MKSH_NEED_MKNOD to embed mknod(8) even if
  MKSH_SMALL is enabled</li>
 <li>do not scan for revoke() on GNU/Linux since it always fails</li>
 <li>simplify GNU/Linux CPPFLAGS and use them for GNU/HURD and
  GNU/kFreeBSD (tested on Debian experimental, thanks to the
  ftbfs.de autobuilder and Michael "azeem" Banck)</li>
 <li>fix the 'bind' (no args) builtin output</li>
 <li>new #ifdef MKSH_ASSUME_UTF8 to not check setlocale() and
  nl_langinfo(CODESET) if we want to always enable the utf-8
  command line editing mode</li>
 <li>tabcomplete a newline to singlequote+newline+singlequote
  instead of backslash+newline which is eaten; thanks to
  Thomas E. "TGEN" Spanjaard for noticing</li>
 <li>remove shebang line from check.pl which isn't +x anyway</li>
 <li>fix 'hd' alias in dot.mkshrc example to not run off
  an ANSI standard 80 column screen; simplify</li>
 <li>integrate MKSH_NEED_MKNOD and MKSH_ASSUME_UTF8 with Build.sh</li>
 <li>Work around Solaris /usr/ucb/tr, Solaris /usr/xpg4/bin/tr,
  Minix 3 /usr/bin/tr, and SUSv3 deficiencies</li>
 <li>Fix compilation on more platforms (Interix, Cygwin, Linux 2.0 libc5,
  Debian GNU/kFreeBSD, Debian GNU/HURD, &#8230;)</li>
 <li>Use autoconfiguration for persistent history stuff</li>
 <li>Fix the code (add "const" in like 1001 places) to be able to
  build without <tt>-Wno-cast-qual</tt> (hope it's safe now)</li>
 <li>Optionally use const-debugging versions of strchr(3), strstr(3),
  to work around deficiencies in ANSI C</li>
 <li>The above directly led to our own strcasestr(3) implementation
  for OSes which don't have it</li>
 <li>Optimise <tt>dot.mkshrc</tt> macros</li>
 <li>Let <tt>dot.mkshrc</tt> not return failure early</li>
 <li>Remove shadowing warnings for more OSes</li>
 <li>Support old ash(1) versions in Build.sh</li>
 <li>Support use of <tt>_NSIG</tt> for <tt>NSIG</tt></li>
 <li>Optimise ctags(1) generation</li>
</ul>
<p>Upgrading to mksh R28 with these changes is highly recommended:</p><ul>
 <li>For these who build software as root, the regression testsuite
  has been adapted to pass when using a priviledgued shell. You have
  been warned, though. Do not compile software as root.</li>
 <li>Fix some more <tt>-Wchar-subscripts</tt> on NetBSD&reg;</li>
 <li>Adjust manual page to the fact that mksh can be used as
  <tt>/bin/sh</tt> although it's not specifically designed to</li>
 <li>Simplify mdoc/nroff macro load in manual page</li>
 <li>Add sample file: <tt>dot.mkshrc</tt></li>
 <li>Correct and enhance book citation list in the manual page</li>
 <li>Bring back the "version" editing command in both emacs and
  vi modes, at <tt>ESC ^V</tt> like AT&amp;T ksh93r+</li>
 <li>Fix typo which resulted in the wrong names for signals being
  printed (error codes were used instead) on GNU/Linux, Solaris
  and GNU/Cygwin. Ease changing signame/siglist sources.</li>
 <li>Some more code cleanup and redundancy removal</li>
 <li>Merge a few OpenBSD changes, yielding better multiline prompt
  support and textual improvements in the manual page</li>
 <li>Adjust $PS1 sizing, printing, and redrawal routines
  for mksh behaviour and single- and multiline prompts</li>
 <li>Unbreak build process on Cygwin, fix manpage generation</li>
 <li>For the AT&amp;T $PS1 hack (second char = CR), do not
  output the delimiting characters any more, even if they
  are printable &ndash; fixes platforms without non-printable
  characters (Interix, Cygwin) and prompt size calculation</li>
 <li>Calculate length of prompt in lines and columns-of-last-line
  instead of using some tricks to skip the beginning of the prompt,
  resulting in correct redrawing of prompts with ANSI colour codes</li>
 <li>Correct displaying of prompts spanning more than one line
  and/or with embedded newlines or carriage returns; correct
  documentation of $PS1 and the redraw editing command</li>
 <li>Change one of the testsuite "expected failure" tests from bug
  to feature &ndash; it might actually be required by make(1)</li>
 <li>Enable to bind key sequences which consist of the usual optional
  one or two pr&aelig;fices and the control character, as well as an
  optional trailing tilde (if the trailing character is not a tilde,
  it's processed as usual, but processing of the editing command is
  postponed until after the trailing character has been read)</li>
 <li>Bind the NetBSD&reg; wscons (vt220 / wsvt25), GNU screen and
  XFree86&reg; (xterm-xfree86) &quot;home&quot;, &quot;end&quot;
  and &quot;delete&quot; keys to ^A, ^E and ^D, respectively, except
  that &quot;delete&quot; does not act as logoff switch</li>
 <li>Correct <tt>Test.sh</tt> shebang line</li>
 <li>Make sure ^T is bound to 'transpose' as documented
  (bug spotted by hondza)</li>
 <li>Remove the 'stuff' and 'stuff-reset' editing commands</li>
 <li>Correct the manual page regarding the 'abort' command, its
  interaction with 'search-history' and how to exit the latter</li>
 <li>Bring back "set -o posix" turning off 'braceexpand'</li>
 <li>Mention IRC channel <tt>#mksh</tt>/Freenode in manual page</li>
 <li>Merge <tt>gensigs.sh</tt> into <tt>Build.sh</tt>, eliminating
  the need for <tt>$SHELL</tt> and making it more robust to broken
  user shells such as zsh, use the mksh just built for <tt>Test.sh</tt>;
  simplify CPPFLAGS and reduce size of generated table</li>
 <li>Run the signal name generator only if needed</li>
 <li>Use the -c option to GNU nroff, always</li>
 <li>Make the &quot;all commands of a pipeline are executed in a
  subshell&quot; issue a dependable mksh feature</li>
 <li>Improve regression test comments and a few tests</li>
 <li>If $RANDOM is generated from arc4random(3), display at
  most 31 bits of it like nbsh(1), instead of only 15 bits.</li>
 <li>Rename the regression test script from Test.sh to test.sh</li>
 <li>Improve Build.sh output regarding other files than the binary</li>
 <li>Mention <tt>#ksh</tt>/Freenode in the manual page, since its
  founder (twkm) said it's okay and on-topic as well</li>
 <li>Fix persistent history, add regression test</li>
 <li>Check for arc4random(3) and arc4random_push(3) by using
  the compiler instead of hardcoding OSes which have and which
  don't, because that's not always true</li>
 <li>Fix some regression tests (based upon user feedback too)</li>
</ul>
<p>We recommended mksh <b>R27e</b> to be used:</p><ul>
 <li>Allow <tt>Test.sh</tt> to be passed parameters (-v)</li>
 <li>Fix all <tt>-Wchar-subscripts</tt> on Solaris/sparc64
  and NetBSD&reg;/alpha and remove <tt>-Wno-char-subscripts</tt>
  from Build.sh</li>
 <li>Correct date in version and manual page</li>
</ul>
<p>What became of mksh <b>R27d</b> in the meanwhile?</p><ul>
 <li>Changes for easier crossbuildability</li>
 <li>Honour $CPPFLAGS in gensigs.sh</li>
 <li>Only source ${ENV:-~/.mkshrc} for interactive (FTALKING) shells</li>
 <li>There's a chance that non-MirOS systems have arc4random_push(3)
  at some time in the future, so make it configurable.</li>
</ul>
<p>Featuring mksh <b>R27c</b> with these changes:</p><ul>
 <li>emacs-usemeta now behaves like vi-show8 (be careful with 0x80-0x9F)</li>
 <li>Portability cleanup and speed-up; refine pr&aelig;processor defns</li>
 <li>GNU groff compatible manual page</li>
 <li>Fixes for Solaris 10 support</li>
 <li>Add <tt>~/.mkshrc</tt> as $ENV feature (see manual page)</li>
 <li>Illustrate interactive shell tricks ($PS1) in manual page</li>
 <li>Enhance testsuite</li>
 <li>Incorporate some more code cleanup by OpenBSD</li>
 <li>Reference the O'Reilly books in the manual page</li>
 <li>R27c: fix packaging errors of previous versions</li>
</ul>
<p>Changes in the minor version <b>R26c</b>, relative to R26b:</p><ul>
 <li>Code cleanup by OpenBSD</li>
 <li>Documentation enhancements</li>
 <li>Fix gcc4 warnings in portable mksh</li>
</ul>
<p>Changes in the minor version <b>R26b</b>, relative to R26:</p><ul>
 <li>Makeup changes to copyright file (change comment leader)</li>
 <li>Sync licence with MirOS template (disclaimer changed a little)</li>
 <li>When building, generate a <tt>./Test.sh</tt> on the fly which
  can be used instead of having to copy and paste a long line to run
  the regression test suite (still no way to run ifs.sh as we cannot
  distribute it, though).</li>
 <li>Add a few programming tricks to the manual page</li>
 <li>Fix abuse of unquoted characters in the manual page</li>
 <li>(no actual source code changes)</li>
</ul>
<p>New major version <b>R26</b> changed this, relative to R25b:</p><ul>
 <li>Change the behaviour of <tt>\"</tt> in here documents to
  adhere SUSv3 (inspired by OpenBSD, most code by tg@)</li>
</ul>
<p>New minor version <b>R25b</b> contains these changes:</p><ul>
 <li><tt>arc4random_push(3)</tt> does not exist on older MirOS
  systems; fixes build on MirOS #7quater</li>
 <li>Add GNU Cygwin to the list of supported platforms</li>
</ul>
<p>New major version <b>R25</b> contains these changes:</p><ul>
 <li>Some manual page fixes and updates</li>
 <li>On window resizing, the COLUMNS and LINES variables are updated
  automatically, not only after the next command (from OpenBSD)</li>
 <li>Fix some redraw problem (from OpenBSD)</li>
 <li>Allow &lt; and &gt; for test and [, not only [[</li>
 <li>If an array index is out of bounds, tell which one (from OpenBSD)</li>
 <li>Add mknod(8) for pipes (user/root) and devices (root only) as a
  shell builtin &ndash; idea and some of the code from OpenBSD</li>
 <li>Improve compatibility with Solaris, GNU/Linux, Darwin, Interix</li>
 <li>Prevent redefinition of __rcsid string on systems without __RCSID
  macro (found by Han Boetes)</li>
 <li>Remove the need to manually specify -d on some OSes which need it</li>
 <li>Add a compiler flag to reduce some spurious Solaris-only warnings</li>
</ul>
<p>R24c is another clean-up release, with no change to KSH_VERSION.</p><ul>
 <li>Document stance on quoting policy in here documents</li>
 <li>More fixes for GCC 4 warnings</li>
</ul>
<p>R24b is a minor clean-up relase, recommended especially on Darwin.</p><ul>
 <li>please GCC 4 with the usual crazy set of warning flags</li>
 <li>remove 'version' editor binding and remap emacs ^V to quote-meta ('literal')</li>
 <li>use open(2) instead of creat(3), from OpenBSD</li>
 <li>[bsiegert] fix order of includes</li>
 <li>some code simplification; no explicit LFS needed any more</li>
</ul>
<p>R24 is an <b>important bug fix</b> release and the new required
 minimum version to be installed for MirMake. Changes are:
</p><ul>
 <li>GNU/Cygwin is now supported but not officially tested</li>
 <li>DragonFly BSD is now supported and officially tested</li>
 <li>FreeBSD should work as a side effect of the above</li>
 <li>On NetBSD, arc4random(3)
  can now be used if it exists</li>
 <li>no longer look at argv[0] to determine if restricted shell</li>
 <li>changes to $EDITOR and $VISUAL no longer affect the current
  editing mode</li>
 <li>emacs on, emacs-usemeta off is now the default editing mode</li>
 <li>the special "posix" and "sh" modes are gone</li>
 <li>code, test suites and documentation have been cleaned up a little</li>
 <li>Korn's bizarre /dev/fd hack is now no longer supported</li>
 <li>undo fix for Debian PR #71256 which turned to be bogus and break make(1)</li>
 <li>fix compilation and invocation of test suite with whitespace in the
  pathnames for real, this time</li>
 <li>the distfile is now signed using gzsig(1)</li>
</ul>
<p>R23 comes with an overhauled build system providing more flags for
 easier configuration, a bug-fix if the relative path to $0 contained
 a space, and does not need h2ph(1) to
 build some headers any more. Also, the code has cleaned up a bit and
 some manual page glitches were corrected. Some of these changes
 originated by Han Boetes, a few came via the OpenBSD project.</p>
<p>R22d is the first version which works if source or build directory
 contain spaces in the pathname. It also allows building without
 bothering to pre-format the manual page.</p>
<p>R22c contains some compile time warning fixes on non-MirOS platforms.</p>
<p>R22b contains an important fix regarding the srand(3) initialisation logic and a
 portability fix for NetBSD.</p>
<p>R22 is the result of three different kinds of work: integrating diffs
 from Debian's pdksh package, as needed, including fixing bugs and of
 course testing and fixing docs; fixing the dreaded emacs-mode filename
 with brackets (hello AONE); much cleanup and polishing. Also, the new
 codebase has been tested on a fair number of systems now, with more to
 follow (maybe even new, currently unsupported, platforms).</p>
<p>R20b contains some minor arc4random and build fixes against R20.</p>
<p>R21 has been a three-way integration work from OpenBSD-current's ksh,
 MirOS-current's ksh and portable mksh R20. This is the first release
 to come without autoconf'd script; it is much smaller and installs
 both faster and easier. Several bugs have been fixed, the testsuite
 has been enhanced and the code was cleaned up largely. pdksh lookalikeness
 was largely dropped, and support for octal and sedecimal (hexadecadic)
 numbers via prefixing with <em>0</em> or <em>0x</em> has been added.
 <strong>This is an experimental release; it is not <i>yet</i> supported
 e.g. by MirMake – make(1) – or other tools</strong> but this
 will follow soon. MirbsdKsh R21 is to be the only shell available on
 MirOS #9.</p>
<p>R20 integrated an experimental bugfix from millert@openbsd and shuffled
 some code around. OS/2 support vanished, and the rest of the code shrank
 and was optimised. This is the first version since v1.11 to work on SFU
 (Interix) 3.5 as-is. The upgrade to R20 is <em>highly</em> recommended.
 Note: the mksh R20 distfile has changed from before Dec 14, 16:00.</p>
<p>R19 changes back a bugfix from R18 which caused a regression (from
 OpenBSD) and changed behaviour to match ksh88 on Solaris (from OpenBSD).</p>
<p>v1.18 (R18) fixes some core dump bugs and is a recommended update.</p>
<p>v1.17 comes out with the final MirOS licence template applied, but not
 yet OSI approved (it's not our fault though). There are regression fixes
 and bug fixes; IFS field splitting now works as documented. This version
 is a major improvement both over v1.16 and OpenBSD /bin/ksh, so please
 use it and report possible bugs.</p>
<p>v1.16 IS A BETA VERSION, use at your own risk. This version comes with
 a code cleanup session (for compilation with -Wall -Werror -W -pedantic
 and in preparation for doing an indent(1)
 whack over the source; any volunteers?) and some new features (with -T
 it spawns on a different tty than you're on - cool for single user mode)
 and code removed (the mailbox checking functionality, since everyone sane
 uses UW-IMAPD to access his MBX format folder using IMAPS, port 993, even
 to localhost). The code is also ANSIfied and protoised, in preparation for
 style(9) aka KNF.</p>
<p>There were no v1.13, v1.14, and v1.15 was never released as portable
 version. MirbsdKsh version numbers were pretty much RCS IDs at the
 time of writing this paragraph.</p>
<p>v1.12 fixes the manpages and minor stuff, as well as a signalling bug
 and the inability to build without gcc installed as gcc. It also
 adds installation hints for various operating systems.</p>
<p>v1.11 is a minor update to v1.10 with a few build and style fixes only.</p>

<h2 id="vsn">Recommendations on version numbering</h2>
<p>mksh by default uses a version numbering scheme that uses full integers,
 prefixed by a capital letter R significing “Release”. If minor updates are
 required or requested, a lower-case letter from the standard latin alphabet
 will be appended, starting at ‘b’ and ending at ‘z’ (but usually way before
 or at ‘i’). If a packaging system cannot handle version numbers such as
 <tt>mksh-R29b</tt> (source) → <tt>mksh-R29b-1</tt>, <tt>mksh-R29bp1</tt>
 (binary), packagers OUGHT TO map this to a numerical system as follows:
 <tt>mksh-29.2-1</tt>, <tt>mksh-29.2.1</tt>, <tt>mksh-29.2nb0</tt>, depending
 on the packaging-system local policy for build numbers / patchlevels.</p>
<p>Schemes to AVOID are <tt>mirbsdksh-1.29b</tt>, <tt>mksh-2.9.2</tt>, or
 worse. Please adhere to our recommendations so that users are able to locate
 mksh in their operation environment of choice.</p>

<h3 id="editor">/bin/ed</h3>
<p>While we’re at it – recommendations for packagers – there is another set
 of do’s and dont’s: location of the UNIX® standard text editor. As outlined
 in traditional unixoid operating system standards, manifested into POSIX,
 and – for these three-letter words that aren’t Unix, no matter which of the
 kernels they use in their variety of so-called distributions – the <a
 href="http://www.pathname.com/fhs/pub/fhs-2.3.html#SPECIFICOPTIONS2">FHS</a>
 (FSSTND): ed lives in <tt>/bin/ed</tt>, period.</p>
<p>Patching mksh’s code to look for ed in ANY other location is a MUST NOT.</p>

<h2 id="plans">Future Plans</h2><ul>
<li><a href="mksh.htm#plans">newer plans</a></li>
<li>bash-style multiline command line editing, as an option (the current
 horizontally scrolled one is finally (with R28) bug-free even with
 multiline and very long prompts optionally with embedded newlines,
 and more suitable for small terminals)</li>
<li>Ensure arithmetics are properly bound to <tt>mksh_ari_t</tt> and
 <tt>mksh_uari_t</tt> and offer switching to 64 bit, including as
 array index type, as a compile time option;
 seeing as some systems (DEC?) may not have a 64 bit type</li>
<li>Adding <tt>goto</tt> and <tt>label</tt> keywords/commands</li>
<li>Can not [[ or (( yield the inode of a file, if we don’t get
 a stat(1) builtin? (For hashes by file.) Maybe make a builtin
 that expands <tt>struct stat</tt> into an associative array?</li>
<li>Adding builtins <tt>fstat</tt>, <tt>lstat</tt>, <tt>traverse</tt>, …</li>
<li>for a b in …; do (like make(1) does)</li>
<li>${foo:S/bar/baz/g} and maybe ${foo:C/bar/baz/x} via regex(3)</li>
<li>A sensible website</li>
<li>Mode for no input line editing at all (required for Plan 9)
 and no Emacs just Vi mode (requested by unknown at FOSDEM 2009 – yuck)</li>
<li>Real Unicode command line editing code</li>
<li>Real Unicode internal op – ${foo:2:3} now works with MirOS OPTU-8
 but having internal representation being MirOS OPTU-16 would help in
 the long term</li>
<li><tt>/etc/mkshrc</tt> (maybe only if ~/.mkshrc does not exist,
 with similar rules; ENV=/ could be the magic "default" value;
 maybe go through $ENV -&gt; ~/.mkshrc -&gt; /etc/mkshrc by both
 existence and being &gt;0 bytes...</li>
<li>An option to rot13 the mirtoconf output (build log scanners
 are Moste Annoying)</li>
</ul>
EOF
mws_putfooter
exit 0
