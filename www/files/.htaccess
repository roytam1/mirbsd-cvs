# $MirOS: www/files/.htaccess,v 1.6+1 2008/09/17 21:12:18 tg uncommitted $

Options ExecCGI Indexes SymLinksIfOwnerMatch
IndexOptions -FancyIndexing
AddHandler cgi-script .cgi
DirectoryIndex main.htm

# redirections for HTML documentation
RedirectMatch 301 ^/cman(/*)$ /htman/i386/
RedirectMatch 301 ^/cman/man([1-9]|DOCS|INFO|PAPERS|PSD|SMM|USD)(/*)$ /htman/i386/man$1/
RedirectMatch 301 ^/cman/(.*\.html*$) /htman/i386/$1
RedirectMatch 301 ^/cman/(.*$) /htman/i386/$1.htm
RedirectMatch 301 ^/man(/*)$ /htman/i386/
RedirectMatch 301 ^/man(i386|sparc)(/*)$ /htman/$1/
RedirectMatch 301 ^/man(i386|sparc)/man([1-9]|DOCS|INFO|PAPERS|PSD|SMM|USD)(/*)$ /htman/$1/man$2/
RedirectMatch 301 ^/man(i386|sparc)/(.*)\.([1-9]|PAPERS|PSD|SMM|USD)$ /htman/$1/man$3/$2.htm
RedirectMatch 301 ^/man(i386|sparc)/(.*)\.(INFO|info)$ /htman/$1/manINFO/$2.html
RedirectMatch 301 ^/man(i386|sparc)/man(.*\.htm$) /htman/$1/man$2
RedirectMatch 301 ^/man(i386|sparc)/man(.*$) /htman/$1/man$2.htm
RedirectMatch 301 ^/man(i386|sparc)/(.*\.htm$) /htman/$1/man$2
RedirectMatch 301 ^/man(i386|sparc)/(.*$) /htman/$1/man$2.htm
RedirectMatch 301 ^/man([1-9]|DOCS|INFO|PAPERS|PSD|SMM|USD)(/*)$ /htman/i386/man$1/
RedirectMatch 301 ^/man([1-9]|DOCS|INFO|PAPERS|PSD|SMM|USD)/(.*\.html*$) /htman/i386/man$1/$2
RedirectMatch 301 ^/man([1-9]|PAPERS|PSD|SMM|USD)/(.*$) /htman/i386/man$1/$2.htm
RedirectMatch 301 ^/man(info|INFO)/(.*$) /htman/i386/manINFO/$2.html
RedirectMatch 301 ^/man(docs|DOCS)/(.*$) /htman/i386/manDOCS/$2
RedirectMatch 301 ^/man/(.*)\.([1-9]|PAPERS|PSD|SMM|USD)$ /htman/i386/man$2/$1.htm
RedirectMatch 301 ^/man/(.*)\.(INFO|info)$ /htman/i386/manINFO/$1.html

# redirects for legacy links (mod_alias cannot inspect query strings)
RewriteEngine On
RewriteCond %{QUERY_STRING} ^([^/]+)$
RewriteRule ^(index.php)?$ /%1.htm? [R=301,L]

# file types
AddType 'text/html; charset=utf-8' htm
AddType 'text/html' html
AddType 'application/octet-stream' bz2 dsc fs rd ISO iso gz cgz ngz tgz Z
AddType 'text/plain; charset=cp437' asc
AddType 'text/plain; charset=utf-8' txt
AddType 'application/x-x509-ca-cert' cer
AddType 'application/metalink+xml' metalink

# serve XHTML stuff as text/html by default, but upgrade
# to application/xml+xhtml if the client requests it
RewriteEngine On
RewriteCond %{HTTP_ACCEPT} application/xhtml\+xml
RewriteCond %{HTTP_ACCEPT} !application/xhtml\+xml\s*;\s*q=0
RewriteCond %{THE_REQUEST} HTTP/1\.1
RewriteRule \.htm$ - [T=application/xhtml+xml]

# forced text files
<Files LICENCE>
  ForceType text/plain
</Files>

<Files ISC-Licence>
  ForceType text/plain
</Files>

<Files MirOS-Licence>
  ForceType text/plain
</Files>

# "hidden" files
<Files cvsweb.conf>
  Order deny,allow
  Deny from all
</Files>
